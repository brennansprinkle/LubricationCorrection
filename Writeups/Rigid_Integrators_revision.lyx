#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass revtex4
\begin_preamble
\usepackage{ae,aecompl}

%\usepackage[T1]{fontenc}
%\usepackage{lmodern}

%\usepackage[normalmargins,normalbib,normaltitle,normalsections,normalindent]{savetrees}
%\usepackage[margins=normal,bibnotes=normal]{savetrees}

\providecommand{\onlinecite}{\cite}
\providecommand{\onlineref}{\ref}

\usepackage{amsthm,mathtools}
\theoremstyle{plain}
\newtheorem{thm}{Result}
\numberwithin{thm}{subsection}
\newtheorem{lem}{Result}
\numberwithin{lem}{subsection}

\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

% Make blue the only color used (for Boyce)
%\renewcommand{\lyxadded}[3]{{\color{blue}{}#3}}
%\renewcommand{\lyxdeleted}[3]{{\color{blue}\sout{#3}}}
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
% Added by lyx2lyx
\end_preamble
\options aip,letter,superscriptaddress,floatfix,jcp,11pt
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\float_placement h
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 2
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes true
\output_changes true
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\author -1931946903 "brennan"
\author -1422339205 "Aleksandar Donev,,,"
\author 2030352201 "fbalboausabiaga"
\end_header

\begin_body

\begin_layout Title
Large Scale Brownian Dynamics of Confined Suspensions of Rigid Particles
\end_layout

\begin_layout Author
Brennan Sprinkle
\end_layout

\begin_layout Affiliation
McCormick School of Engineering, Northwestern University, Evanston, IL 60208
\end_layout

\begin_layout Author
Florencio Balboa Usabiaga
\end_layout

\begin_layout Affiliation
Courant Institute of Mathematical Sciences, New York University, New York,
 NY 10012
\end_layout

\begin_layout Affiliation
Center for Computational Biology, Flatiron Institute, Simons Foundation,
 New York 10010, USA
\end_layout

\begin_layout Author
Neelesh A.
 Patankar
\end_layout

\begin_layout Affiliation
McCormick School of Engineering, Northwestern University, Evanston, IL 60208
\end_layout

\begin_layout Author
Aleksandar Donev
\end_layout

\begin_layout Author Email

donev@courant.nyu.edu
\end_layout

\begin_layout Affiliation
Courant Institute of Mathematical Sciences, New York University, New York,
 NY 10012
\end_layout

\begin_layout Abstract

\color black
We introduce methods for large scale Brownian Dynamics (BD) simulation of
 many rigid particles of arbitrary shape suspended in a fluctuating fluid.
 Our method adds Brownian motion to the rigid multiblob method [F.
 Balboa Usabiaga 
\emph on
et al.
\emph default
, Communications in Applied Mathematics and Computational Science, 11(2):217-296
, 2016] at a cost comparable to the cost of deterministic simulations.
 We demonstrate that we can efficiently generate deterministic and random
 displacements for many particles using preconditioned Krylov iterative
 methods, if kernel methods to efficiently compute the action of the Rotne-Prage
r-Yamakawa (RPY) mobility matrix and it 
\begin_inset Quotes eld
\end_inset

square
\begin_inset Quotes erd
\end_inset

 root are available for the given boundary conditions.
 These kernel operations can be computed with near linear scaling for periodic
 domains using the Positively Split Ewald method.
 Here we study particles partially confined by gravity above a no-slip bottom
 wall using a graphical processing unit (GPU) implementation of the mobility
 matrix vector product, combined with a preconditioned Lanczos iteration
 for generating Brownian displacements.
 We address a major challenge in large-scale BD simulations, capturing the
 stochastic drift term that arises because of the configuration-dependent
 mobility.
 Unlike the widely-used Fixman midpoint scheme, our methods utilize random
 finite differences and do not require the solution of resistance problems
 or the computation of the action of the inverse square root of the RPY
 mobility matrix.
 We construct two temporal schemes which are viable for large scale simulations,
 an Euler-Maruyama traction scheme and a Trapezoidal Slip scheme, which
 minimize the number of mobility solves per time step while capturing the
 required stochastic drift terms.
 We validate and compare these schemes numerically by modeling suspensions
 of boomerang shaped particles sedimented near a bottom wall.
 Using the trapezoidal scheme, we investigate the steady-state active motion
 in a dense suspensions of confined microrollers, whose height above the
 wall is set by a combination of thermal noise and active flows.
 We find the existence of two populations of active particles, slower ones
 closer to the bottom and faster ones above them, and demonstrate that our
 method provides quantitative accuracy even with relatively coarse resolutions
 of the particle geometry.
\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\V}[1]{\boldsymbol{#1}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\M}[1]{\boldsymbol{#1}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Set}[1]{\mathbb{#1}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\D}[1]{\Delta#1}
\end_inset


\begin_inset FormulaMacro
\newcommand{\d}[1]{\delta#1}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\norm}[1]{\left\Vert #1\right\Vert }
\end_inset


\begin_inset FormulaMacro
\newcommand{\abs}[1]{\left|#1\right|}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\grad}{\M{\nabla}}
{\boldsymbol{\nabla}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\avv}[1]{\langle#1\rangle}
\end_inset


\begin_inset FormulaMacro
\newcommand{\av}[1]{\left\langle #1\right\rangle }
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\P}{\mathcal{P}}
{\mathcal{P}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\ki}{k}
{k}
\end_inset


\begin_inset FormulaMacro
\newcommand{\wi}{\omega}
{\omega}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\slip}{\breve{\V u}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\bu}{\V u}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\bv}{\V v}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\br}{\V r}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\sM}[1]{\M{\mathcal{#1}}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Mob}{\sM M}
\end_inset


\begin_inset FormulaMacro
\newcommand{\J}{\sM J}
\end_inset


\begin_inset FormulaMacro
\newcommand{\S}{\sM S}
\end_inset


\begin_inset FormulaMacro
\newcommand{\L}{\sM L}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\N}{\sM N}
\end_inset


\begin_inset FormulaMacro
\newcommand{\K}{\sM K}
\end_inset


\begin_inset FormulaMacro
\newcommand{\slipN}{\breve{\N}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\aN}{\widetilde{\N}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\aK}{\widetilde{\K}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\aMob}{\widetilde{\Mob}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\epsN}{\overline{\N}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\slipW}{\breve{\V W}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\rot}{\M{\Psi}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Rot}{\M{\Xi}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\eqd}{\overset{d}{=}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%
\backslash
setlength{
\backslash
abovedisplayskip}{0.35ex}
\backslash
setlength{
\backslash
belowdisplayskip}{0.35ex}
\end_layout

\begin_layout Plain Layout

%
\backslash
setlength{
\backslash
abovedisplayshortskip}{0.1ex}
\backslash
setlength{
\backslash
belowdisplayshortskip}{0.1ex}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
The study of Brownian suspensions of passive and active particles has become
 ubiquitous, particularly in the biological and physical sciences 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianDynamics_DNA,BrownianReview,Nanomotors_Kapral"

\end_inset

.
 Thermal fluctuations play an integral role in determining the dynamics
 of active suspensions, for example, they affect the development of a recently-d
iscovered fingering instability 
\begin_inset CommandInset citation
LatexCommand cite
key "Rollers_NaturePhys"

\end_inset

 in suspensions of microrollers partially confined by gravity above a no-slip
 wall bottom wall 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
 Efficient simulations of these systems, which correctly capture the effects
 of Brownian motion, are essential for designing and understanding experimental
 results as well as discovering new collective phenomena.
 The purpose of this work is to design scalable and accurate numerical methods
 for Brownian Dynamics (BD) simulation of suspensions of many passive and/or
 active rigid particles of arbitrary shape.
 By scalable, we mean that the computational complexity of the method should
 scale (nearly) 
\emph on
linearly
\emph default
 with the number of particles considered.
 By accurate, here we mean that the temporal integrators used should be
 second-order accurate in the deterministic setting (i.e., without Brownian
 motion), and maximize the weak accuracy for a given computational cost
 per unit simulation time.
 To our knowledge, this is the first time either of these goals have been
 accomplished with 
\emph on
controlled
\emph default
 accuracy for a suspension of particles of arbitrary shape.
 Existing methods based on uncontrolled multipole truncations 
\begin_inset CommandInset citation
LatexCommand cite
key "StokesianDynamics_Brownian,FluctuatingFCM_DC,BoundaryIntegralWall_Adhikari"

\end_inset

 are focused on spheres and spheroids and are difficult to generalize to
 general particle shapes, though some special shapes like thin rods have
 been tackled using slender body theory 
\begin_inset CommandInset citation
LatexCommand cite
key "BD_Rods_Shaqfeh"

\end_inset

.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

 some of us proposed a flexible and scalable 
\emph on
rigid multiblob
\emph default
 method for simulation of many rigid bodies (not necessarily spherical)
 in Stokes flow, in the absence of Brownian motion.
 In the rigid multiblob method 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs,BrownianMultiBlobs"

\end_inset

, complex particle shapes are constructed with tunable resolution (accuracy)
 as a rigidly-connected cluster of spherical 
\begin_inset Quotes eld
\end_inset

blobs
\begin_inset Quotes erd
\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

 some of us developed efficient preconditioned Krylov methods for solving
 mobility problems in computational cost that scales (nearly) linearly with
 the number of blobs used to construct the rigid particles.
 Here we focus on efficient computation of stochastic displacements consistent
 with the overdamped Langevin equation for non-spherical particles proposed
 by some of us in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 In the prior work 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

 we assumed a small number of particles and performed direct (Cholesky)
 factorization of mobility matrices to compute Brownian increments, which
 scales as the cube of the number of blobs and is infeasible for many-body
 suspensions.
 In this work we develop linear-scaling preconditioned iterative methods
 for computing the stochastic increments of particle positions and orientations.
 A second nontrivial challenge we address is the construction of consistent
 and accurate temporal integrators.
 The widely-used Fixman midpoint temporal integrator, generalized to include
 particle orientations in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

, requires solving resistance problems, which cannot be done in linear time
 with present methods 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

.
 Here we construct two temporal integrators that correctly capture stochastic
 drift terms proportional to the divergence of the mobility matrix, and
 require only solving mobility problems.
 While here we only test these novel schemes with the rigid multiblob method
 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

, it is important to note that the same temporal integrators apply to highly-acc
urate boundary integral formulations 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
As explained in detail in Appendix A of 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

, the rigid multiblob method can be seen as a first-kind boundary integral
 method regularized in a physically-consistent way so as to ensure the symmetry
 and positive definiteness of the mobility matrix, as required for adding
 Brownian motion.
\end_layout

\end_inset

 for Stokesian suspensions 
\begin_inset CommandInset citation
LatexCommand cite
key "BoundaryIntegral_Pozrikidis,BoundaryIntegral_Periodic3D,BoundaryIntegral_SpheroidQBX"

\end_inset

.

\change_inserted -1422339205 1510612409
 Furthermore, while we focus here on suspensions confined above a no-slip
 wall, the methods we present here are rather general and can be applied
 to other systems such as bulk passive or active suspensions.
\change_unchanged

\end_layout

\begin_layout Standard
In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Nhalf"

\end_inset

, we develop a scalable method to generate the Brownian increments for the
 particles from the Brownian increments of the individual blobs, which can
 themselves be computed using a preconditioned Lanczos method 
\begin_inset CommandInset citation
LatexCommand cite
key "SquareRootPreconditioning"

\end_inset

, as previously described for particles above a no-slip wall in 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

, and for periodic suspensions in 
\begin_inset CommandInset citation
LatexCommand cite
key "SpectralRPY"

\end_inset

.
 In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "Traction"

\end_inset

 we propose a novel modification of the Euler-Maruyama (EM) scheme, which
 involves solving only a 
\emph on
single
\emph default
 additional mobility problem in order to capture the Ito stochastic (thermal)
 drift required to maintain the Gibbs-Boltzmann distribution at equilibrium.
 This is a notable improvement over the EM method proposed in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

 which requires 
\emph on
two
\emph default
 additional mobility solves to compute the drift using a 
\emph on
random finite difference
\emph default
 (RFD).
 In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Slip"

\end_inset

 we propose a novel trapezoidal scheme which also captures the correct thermal
 drift by solving only a single additional mobility problem, and is second
 order accurate in time for deterministic calculations.
 While the scheme is formally only first-order weakly accurate in the stochastic
 setting, the improved deterministic accuracy translates to substantially
 improved weak accuracy, as we demonstrate numerically.
\end_layout

\begin_layout Standard
In sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:TwoBooms"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ManyBooms"

\end_inset

, we validate the new temporal integrators and compare their efficiency/accuracy
 tradeoffs by examining equilibrium statistics for suspensions of passive
 colloidal boomerangs confined above a wall.
 In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BrownRoll"

\end_inset

 we revisit some experimental and computational investigations done in 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

 for dense uniform suspensions of rotating colloids (microrollers) above
 a planar wall.
 In this prior work 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

, a large mismatch was observed between experimental measurements of the
 steady-state mean suspension velocity and estimates based on the minimally-reso
lved Brownian dynamics computations 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
 Here we are able to simulate a dense uniform suspension of microrollers
 with much higher resolution.
 The higher resolution allows us to better resolve the hydrodynamic interactions
 between the particles and make quantitative predictions that are sufficiently
 accurate to be directly compared to experiments.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:BD"

\end_inset

 Brownian Dynamics for Rigid Bodies
\end_layout

\begin_layout Standard
We consider a suspension of 
\begin_inset Formula $N_{b}$
\end_inset

 passive or active rigid bodies (particles) suspended in a fluctuating Stokesian
 fluid.
 For body 
\begin_inset Formula $p\in[1,\ldots,N_{b}]$
\end_inset

, we will follow a reference
\emph on
 tracking point
\emph default
 with Cartesian position, 
\begin_inset Formula $\V q_{p}\left(t\right)$
\end_inset

.
 The orientation of body 
\begin_inset Formula $p$
\end_inset

 relative to the tracking point will be denoted by 
\begin_inset Formula $\V{\theta}_{p}\left(t\right)$
\end_inset

.
 For simplicity and increased generality, we make the bulk of the discussion
 in this work agnostic to the choice of coordinates for 
\begin_inset Formula $\V{\theta}_{p}$
\end_inset

 and assume that the representation is a scalar in two dimensions or a three-dim
ensional vector in three dimensions.
 In practice, however, we use unit quaternions in three dimensions, as discussed
 in detail in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 The unit norm constraint of the quaternion can be handled simply by updating
 orientation using quaternion multiplication (rotations) instead of addition,
 as detailed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "Add:Quat"

\end_inset

.
 We denote the generalized position of body 
\begin_inset Formula $p$
\end_inset

 as 
\begin_inset Formula $\V Q_{p}\left(t\right)=\left[\V q_{p}\left(t\right),\V{\theta}_{p}\left(t\right)\right]$
\end_inset

 and denote the many-body configuration with 
\begin_inset Formula $\V Q=\left[\V Q_{p}\right]$
\end_inset

.
 To each body 
\begin_inset Formula $p$
\end_inset

, we prescribe an applied force 
\begin_inset Formula $\V f_{p}$
\end_inset

, and an applied torque 
\begin_inset Formula $\V{\tau}_{p}$
\end_inset

, and denote the generalized force on body 
\begin_inset Formula $p$
\end_inset

 with 
\begin_inset Formula $\V F_{p}=\left[\V f_{p},\V{\tau}_{p}\right]$
\end_inset

 and write 
\begin_inset Formula $\V F=\left[\V F_{p}\right]$
\end_inset

.
 The prescription of external (non-conservative) forces and torques is one
 way in which we may model active bodies, the other, active slip, is discussed
 in more detail in 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

 and summarized in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:multN"

\end_inset

.
 
\end_layout

\begin_layout Standard
Given forces and torques, our aim is to find the rigid body velocities 
\begin_inset Formula $\V U=\left[\V U_{p}\right]$
\end_inset

, where the generalized velocity 
\begin_inset Formula $\V U_{p}=\left[\V u_{p},\V{\omega}_{p}\right]$
\end_inset

 is composed of a translational velocity 
\begin_inset Formula $\V u_{p}$
\end_inset

 and a rotational (angular) velocity 
\begin_inset Formula $\V{\omega}_{p}$
\end_inset

.
 A central object in the overdamped Langevin equations for the suspension
 is the configuration-dependent 
\shape italic
body mobility matrix
\shape default
 
\begin_inset Formula $\N\left(\V Q\right)$
\end_inset

.
 In a deterministic setting, the symmetric positive-definite (SPD) matrix
 
\begin_inset Formula $\N$
\end_inset

, relates the generalized velocities with the generalized forces, 
\begin_inset Formula $\V U=\N\V F.$
\end_inset

 The application of the body mobility matrix, i.e., the computation of 
\begin_inset Formula $\V U=\N\V F$
\end_inset

 given 
\begin_inset Formula $\V F$
\end_inset

, is referred to as the 
\shape italic
mobility problem.

\shape default
 Its inverse problem, the 
\shape italic
resistance problem
\shape default
, involves finding the forces and torques given prescribed rigid-body motions,
 i.e., computing 
\begin_inset Formula $\V F=\N^{-1}\V U$
\end_inset

.
 By combining the rigid multiblob method with preconditioned iterative solvers,
 one can solve a mobility problem efficiently in linear time, however, the
 solution of resistance problems is much more expensive and does not scale
 linearly 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

.
\end_layout

\begin_layout Standard
For a suspension of rigid bodies, the configuration evolves according to
 the overdamped Langevin Ito BD equation, 
\begin_inset Formula 
\begin{equation}
\frac{d\V Q}{dt}=\V U=\N\V F+k_{B}T\left(\partial_{\V Q}\cdot\N\right)+\sqrt{2k_{B}T}\ \N^{1/2}\sM W,\label{Langevin}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sM W$
\end_inset

 is a collection of independent white noise processes 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 Here the 
\begin_inset Quotes eld
\end_inset

square root
\begin_inset Quotes erd
\end_inset

 of the mobility 
\begin_inset Formula $\N^{1/2}$
\end_inset

 is any matrix, 
\emph on
not
\emph default
 necessarily square, that satisfies the fluctuation-dissipation relation
 
\begin_inset Formula $\N=\N^{1/2}\left(\N^{1/2}\right)^{T}$
\end_inset

.
 We will refer to the term 
\begin_inset Formula $k_{B}T\ \partial_{\V Q}\cdot\N$
\end_inset

 as the 
\emph on
stochastic
\emph default
 or 
\shape italic
thermal drift
\shape default
 (or sometimes simply the 
\shape italic
drift
\shape default
)
\change_inserted -1422339205 1510610981
 since it has its origin in the stochastic interpretation of the noise;
 this drift term would disappear if the so-called kinetic or Klimontovich
 interpretation of the noise is used 
\begin_inset CommandInset citation
LatexCommand cite
key "KineticStochasticIntegral_Ottinger"

\end_inset


\change_unchanged
.
 Efficient generation of this term will be the most challenging part of
 this work and is discussed in detail in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:RFD"

\end_inset

.
 As a prelude, in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:multN"

\end_inset

 we briefly review the methods proposed in 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

 to efficiently compute the deterministic displacements, 
\begin_inset Formula $\N\V F$
\end_inset

.
 Then, in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Nhalf"

\end_inset

, we propose a scalable iterative method for computing the Brownian displacement
s over a time interval 
\begin_inset Formula $\D t$
\end_inset

, 
\begin_inset Formula $\sqrt{2k_{B}T\,\D t}\ \N^{1/2}\V W$
\end_inset

, where 
\begin_inset Formula $\V W$
\end_inset

 is a vector of independent standard Gaussian random variables.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec:multN"

\end_inset

Solving Mobility Problems
\end_layout

\begin_layout Standard
We discretize the rigid bodies using a rigid multi-blob model, wherein rigid
 bodies are treated as rigid conglomerations of beads, or 
\begin_inset Quotes eld
\end_inset

blobs
\begin_inset Quotes erd
\end_inset

, of hydrodynamic radius 
\begin_inset Formula $a$
\end_inset

.
 The blobs comprising a given rigid body 
\begin_inset Formula $\mathcal{B}_{p}$
\end_inset

 have positions 
\begin_inset Formula $\V r^{(p)}=\left[\V r_{i}\ |\ i\in\mathcal{B}_{p}\right]$
\end_inset

.
 Given a rigid body velocity 
\begin_inset Formula $\V U_{p}=\left[\V u_{p},\V{\omega}_{p}\right]$
\end_inset

, the 
\shape italic
geometric 
\emph on
block matrix
\shape default
\emph default
 
\begin_inset Formula $\K$
\end_inset

 that converts rigid body motion into blob motion is defined as 
\begin_inset CommandInset citation
LatexCommand cite
key "StokesianDynamics_Rigid"

\end_inset

 
\begin_inset Formula 
\begin{equation}
\left(\K\V U\right)_{i}=\V u_{p}+\V{\omega}_{p}\times\left(\V r_{i}-\V q_{p}\right),\hspace{0.5cm}p\in1,\ldots,N_{B}\text{ and }i\in\mathcal{B}_{p}.\label{K}
\end{equation}

\end_inset

Using 
\begin_inset Formula $\K$
\end_inset

, a slip condition on the rigid bodies can be compactly expressed as 
\begin_inset Formula 
\begin{equation}
\dot{\V r}=\K\V U-\slip,
\end{equation}

\end_inset

where 
\begin_inset Formula $\slip$
\end_inset

 is a prescribed slip velocity of the fluid at the locations of the blobs.
 Physically, 
\begin_inset Formula $\slip$
\end_inset

 could account for an active boundary layer 
\begin_inset CommandInset citation
LatexCommand cite
key "BoundaryIntegralGalerkin,BoundaryIntegralWall_Adhikari"

\end_inset

.
 However, in this work, we will find a great deal of utility in prescribing
 
\begin_inset Formula $\slip$
\end_inset

 in such a way as to help generate the stochastic terms in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

).
 The force and torque balance conditions on the particles can be expressed
 using the adjoint of 
\begin_inset Formula $\K$
\end_inset

, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\K^{T}\V{\lambda}=\V F$
\end_inset

 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset CommandInset citation
LatexCommand cite
key "StokesianDynamics_Rigid"

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
.
\end_layout

\begin_layout Standard
The hydrodynamic interactions between blob 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 are captured by the 
\begin_inset Formula $3\times3$
\end_inset

 mobility matrix 
\begin_inset Formula $\M M_{ij}$
\end_inset

, which gives the velocity 
\begin_inset Formula $\dot{\V r}_{i}$
\end_inset

 of blob 
\begin_inset Formula $i$
\end_inset

 given a force 
\begin_inset Formula $\V{\lambda}_{j}$
\end_inset

 on blob 
\begin_inset Formula $j$
\end_inset

, 
\begin_inset Formula $\dot{\V r_{i}}=\M M_{ij}\V{\lambda}_{j}$
\end_inset

.
 The symmetric, positive semi-definite matrix 
\begin_inset Formula $\Mob$
\end_inset

 composed of the blocks 
\begin_inset Formula $\M M_{ij}$
\end_inset

 is termed the 
\shape italic
blob-blob mobility matrix
\shape default
.
 The construction of 
\begin_inset Formula $\Mob$
\end_inset

 for a rigid multiblob must account for the finite hydrodynamic radius of
 the blobs, 
\begin_inset Formula $a$
\end_inset

, as well as the geometry of the domain.
 In the case of a three dimensional unbounded domain, the well-known Rotne-Prage
r-Yamakawa (RPY) tensor 
\begin_inset CommandInset citation
LatexCommand cite
key "RotnePrager,RPY_Shear_Wall"

\end_inset

 can be used to construct 
\begin_inset Formula $\M M_{ij}$
\end_inset

, and the action of 
\begin_inset Formula $\Mob$
\end_inset

 on a vector can be computed in linear time using a fast multipole method
 
\begin_inset CommandInset citation
LatexCommand cite
key "RPY_FMM"

\end_inset

.
 For periodic domains, we can use the Positively Split Ewald (PSE) method
 
\begin_inset CommandInset citation
LatexCommand cite
key "SpectralRPY"

\end_inset

 to compute the action of the RPY-based mobility 
\begin_inset Formula $\Mob$
\end_inset

 on a vector.
 A generalization of the RPY kernel to particles confined above a single
 no-slip wall, the Rotne-Prager-Blake tensor, is given in 
\begin_inset CommandInset citation
LatexCommand cite
key "StokesianDynamics_Wall"

\end_inset

 and we will use it in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Results"

\end_inset

.
 For general fully-confined domains, an on-the-fly procedure to calculate
 
\begin_inset Formula $\Mob$
\end_inset

 has been proposed in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs,RigidIBM"

\end_inset

.
 Note that the action of 
\begin_inset Formula $\Mob$
\end_inset

 can be interpreted as a physically-regularized single-layer (first-kind)
 boundary integral operator (see appendix A of 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

).
\end_layout

\begin_layout Standard
Given 
\begin_inset Formula $\Mob$
\end_inset

, we can write the mobility problem as a linear system 
\begin_inset Formula 
\begin{align}
\Mob\V{\lambda} & =\K\V U-\slip\label{eq:mobU}\\
\K^{T}\V{\lambda} & =\V F,\label{align:FTBAL}
\end{align}

\end_inset

which can be written as the 
\emph on
saddle-point
\emph default
 linear system, 
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\Mob & -\K\\
-\K^{T} & \V 0
\end{bmatrix}\begin{bmatrix}{\V{\lambda}}\\
\V U
\end{bmatrix}=\begin{bmatrix}-\slip\\
-\V F
\end{bmatrix}.\label{eq:saddle}
\end{equation}

\end_inset

Using Schur complements, we can compactly write the solution to (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

) as 
\begin_inset Formula 
\begin{equation}
\V U=\N\V F+\N\K^{T}\Mob^{-1}\slip,\label{eq:sysDense}
\end{equation}

\end_inset

where we have identified the 
\emph on
body mobility matrix
\emph default
 
\begin_inset Formula 
\begin{equation}
\N=\left(\K^{T}\Mob^{-1}\K\right)^{-1}.\label{eq:N_def}
\end{equation}

\end_inset

We note that exactly the same saddle-point system, with a mobility matrix
 
\begin_inset Formula $\Mob$
\end_inset

 computed using singular quadratures instead of the RPY kernel, appears
 in a recently-developed first-kind Fluctuating Boundary Integral Method
 (FBIM) for suspensions 
\begin_inset CommandInset citation
LatexCommand cite
key "FBIM"

\end_inset

.
\end_layout

\begin_layout Standard
In the case of many bodies, computing (the action of) 
\begin_inset Formula $\N$
\end_inset

 directly from equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N_def"

\end_inset

 is very inefficient if at all feasible.
 In practice, we will solve mobility problems by solving (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

) directly.
 Efficient, preconditioned Krylov solvers to solve this system were developed
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

.
 The efficiency of these solvers is dependent, primarily, on the speed at
 which the matrix, 
\begin_inset Formula $\Mob$
\end_inset

, can be applied to a vector.
 If a linear-scaling method such as a fast-multipole-method (FMM) 
\begin_inset CommandInset citation
LatexCommand cite
key "RPY_FMM,OseenBlake_FMM"

\end_inset

 or the PSE method 
\begin_inset CommandInset citation
LatexCommand cite
key "SpectralRPY"

\end_inset

 are used, these methods will scale near linearly (to within logarithmic
 factors) with the total number of blobs.
 Following 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

, here we will use direct dense matrix-vector products implemented on a
 GPU to apply the Rotne-Prager-Blake mobility.
 While this in principle scales quadratically with the total number of blobs,
 modern GPUs are typically powerful enough for a direct implementation of
 a matrix-vector product to outperform more sophisticated techniques up
 to a fairly large number (hundreds of thousands) of blobs 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
 No matter how fast the matrix-vector products with 
\begin_inset Formula $\N$
\end_inset

 (or equivalently 
\begin_inset Formula $\Mob$
\end_inset

) can be computed, solving the system (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

) is one of two bottlenecks in designing efficient integrators to solve
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

).
 We discuss the other bottleneck next.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec:Nhalf"

\end_inset

Computing Brownian increments
\end_layout

\begin_layout Standard
As mentioned in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:multN"

\end_inset

, direct computation of 
\begin_inset Formula $\N=\left(\K^{T}\Mob^{-1}\K\right)^{-1}$
\end_inset

 is computationally infeasible for many bodies due to the dense matrix inversion
s required.
 Direct computation of 
\begin_inset Formula $\N^{1/2}$
\end_inset

, therefore, is still less practical in these situations.
 Our key insight to overcome this is that 
\begin_inset Formula $\N^{1/2}$
\end_inset

 is not unique and doesn't need to be a square matrix, it only needs to
 satisfy 
\begin_inset Formula $\N=\N^{1/2}\left(\N^{1/2}\right)^{T}$
\end_inset

.
 This gives great freedom in choosing 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\N^{1/2}$
\end_inset

 so that its action can be computed in linear time.

\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 We will assume here that we were able to efficiently compute Brownian displacem
ents for the individual blobs, i.e., to compute 
\begin_inset Formula $\Mob^{1/2}\V W$
\end_inset

, where 
\begin_inset Formula $\V W$
\end_inset

 is a vector of independent standard Gaussian random variables.
 This can be done using preconditioned iterative methods for bodies near
 a no-slip wall 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

, using the PSE method 
\begin_inset CommandInset citation
LatexCommand cite
key "SpectralRPY"

\end_inset

 for periodic suspensions, or using the FBIM 
\begin_inset CommandInset citation
LatexCommand cite
key "FBIM"

\end_inset

 for fully confined or periodic suspensions.
\end_layout

\begin_layout Standard
Let us impose the random slip velocity 
\begin_inset Formula $\slip=\sqrt{2k_{B}T/\D t}\ \Mob^{1/2}\V W$
\end_inset

 in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

) 
\begin_inset Foot
status open

\begin_layout Plain Layout
The random slip velocity 
\begin_inset Formula $\slip$
\end_inset

 can be derived by using fluctuating hydrodynamics.
 For example, one can start with the coupled fluid+particle equations given
 in Eq.
 (20) in 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

, and then add a stochastic stress tensor to the Stokes equation for the
 fluid velocity 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs,FBIM"

\end_inset

.
 After elimination of the fluid one obtains (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:noiseSystem"

\end_inset

).
 This can most simply be done by starting from the fully discrete saddle-point
 system (25) in 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

, adding the stochastic stress tensor as done in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs"

\end_inset

, and the using standard Schur complement techniques to eliminate the fluid
 velocity and pressure.
\end_layout

\end_inset

, to get the saddle-point linear system
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\Mob & -\K\\
-\K^{T} & \V 0
\end{bmatrix}\begin{bmatrix}\V{\lambda}\\
\V U
\end{bmatrix}=\begin{bmatrix}-\sqrt{2k_{B}T/\D t}\;\Mob^{1/2}\V W\\
\V 0
\end{bmatrix}.\label{eq:noiseSystem}
\end{equation}

\end_inset

The solution of this system can be written using equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sysDense"

\end_inset

) as 
\begin_inset Formula 
\begin{equation}
\V U=\sqrt{2k_{B}T/\D t}\;\N\K^{T}\Mob^{-1}\Mob^{1/2}\V W=\sqrt{2k_{B}T/\D t}\;\N\K^{T}\Mob^{-1/2}\V W.\label{eq:noiseDense}
\end{equation}

\end_inset

It is not hard to see that we can identify the matrix 
\begin_inset Formula 
\begin{equation}
\N^{1/2}\equiv\N\K^{T}\Mob^{-1/2}\label{eq:sqrtN_def}
\end{equation}

\end_inset

as a 
\begin_inset Quotes eld
\end_inset

square root
\begin_inset Quotes erd
\end_inset

 of the mobility, since 
\begin_inset Formula 
\begin{align}
\N^{1/2}\left(\N^{1/2}\right)^{T} & =\N\K^{T}\Mob^{-1/2}\left(\Mob^{-1/2}\right)^{T}\K\N\\
 & =\N\left(\K^{T}\Mob^{-1}\K\right)\N=\N\N^{-1}\N=\N.
\end{align}

\end_inset

Thus, equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:noiseDense"

\end_inset

) becomes 
\begin_inset Formula 
\begin{equation}
\V U=\sqrt{\frac{2k_{B}T}{\D t}}\;\N^{1/2}\V W.
\end{equation}

\end_inset

Hence the Brownian 
\begin_inset Quotes eld
\end_inset

velocities
\begin_inset Quotes erd
\end_inset

 (more precisely, the Brownian displacements 
\begin_inset Formula $\V U\D t$
\end_inset

) for the rigid bodies can be computed by solving a mobility problem with
 random slip given by Brownian velocities for the blobs.
 Observe that we need only a 
\emph on
single
\emph default
 application of 
\begin_inset Formula $\Mob^{1/2}$
\end_inset

 to a vector, and the solution of a 
\emph on
single
\emph default
 mobility problem, to compute 
\emph on
both
\emph default
 the deterministic and the Brownian increments (but not including the stochastic
 drift terms yet).
 Note that the same construction of 
\begin_inset Formula $\N^{1/2}$
\end_inset

 is used in the recently-developed FBIM 
\begin_inset CommandInset citation
LatexCommand cite
key "FBIM"

\end_inset

, with the slip velocity 
\begin_inset Formula $\slip$
\end_inset

 interpreted as a random surface velocity distribution with covariance equal
 to the Green's function for periodic Stokes flow (i.e., the periodic Stokeslet).
\end_layout

\begin_layout Standard
Given an efficient routine to compute the product 
\begin_inset Formula $\Mob\V{\lambda}$
\end_inset

 for a given 
\begin_inset Formula $\V{\lambda}$
\end_inset

, as discussed in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:multN"

\end_inset

, a preconditioned Lanczos-type iterative method to compute the product
 
\begin_inset Formula $\Mob^{1/2}\V W$
\end_inset

 was proposed in 
\begin_inset CommandInset citation
LatexCommand cite
key "SquareRootPreconditioning"

\end_inset

.
 In unbounded or periodic domains the number of iterations increases with
 the size of 
\begin_inset Formula $\Mob$
\end_inset

, and the cost of computing 
\begin_inset Formula $\Mob^{1/2}\V W$
\end_inset

 is many times than that of computing 
\begin_inset Formula $\Mob\V{\lambda}$
\end_inset

.
 In the PSE method an additional splitting of 
\begin_inset Formula $\Mob$
\end_inset

 into a near-field and far-field components is introduced, and the Lanczos
 method is only applied to the near field, while the far-field component
 is handled using fluctuating hydrodynamics.
 For particles confined close to a no-slip wall, the friction with the floor
 screens the hydrodynamic interactions to decay like inverse distance cubed.
 This makes the Lanczos iteration converge in a small number of iterations
 independent of the number of blobs 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
 However, for rigid multiblobs the number of iterations is higher than for
 single blobs because of the increased ill-conditioning of 
\begin_inset Formula $\Mob$
\end_inset

 due to the presence of (nearly-)touching blobs.
\end_layout

\begin_layout Standard
In this work, we 
\change_deleted -1422339205 1510610554
introduce
\change_inserted -1422339205 1510610557
employ
\change_unchanged
 a block diagonal preconditioner
\change_inserted -1422339205 1510609977
 
\begin_inset Formula $\aMob\approx\Mob$
\end_inset


\change_unchanged
 for the Lanczos algorithm 
\begin_inset CommandInset citation
LatexCommand cite
key "SquareRootPreconditioning"

\end_inset

 that substantially reduces the number of iterations in the computation
 of 
\begin_inset Formula $\Mob^{1/2}\V W$
\end_inset

 for rigid multiblobs.
 
\change_inserted -1422339205 1510610752
Similar block-diagonal or diagonal preconditioners have been used for Stokesian
 suspensions by other authors 
\begin_inset CommandInset citation
LatexCommand cite
key "SPME_Fibers,SD_SpectralEwald,BoundaryIntegral_SpheroidQBX,ForceCoupling_Fluctuations,RigidMultiblobs_Swan"

\end_inset

.

\change_unchanged
 In the preconditioner, which is also used to solve the saddle-point system
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

) 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

, we ignore hydrodynamic interactions between 
\emph on
distinct
\emph default
 bodies
\change_inserted -1422339205 1510610734
 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $q$
\end_inset

, 
\begin_inset Formula $\widetilde{\M{\mathcal{M}}}^{(pq)}=\delta_{pq}\M{\mathcal{M}}^{(pp)}$
\end_inset


\change_unchanged
.
 For each body 
\begin_inset Formula $p$
\end_inset

 we 
\change_deleted -1422339205 1510610422
calculate
\change_inserted -1422339205 1510610734
explicitly form
\change_unchanged
 a 
\change_inserted -1422339205 1510610734
dense 
\change_unchanged
blob-blob mobility matrix 
\change_deleted -1422339205 1510610195
for body 
\begin_inset Formula $p$
\end_inset

,
\change_unchanged
 
\change_deleted -1931946903 1510608021

\begin_inset Formula $\widehat{\M M}_{p}$
\end_inset


\change_inserted -1931946903 1510608027

\begin_inset Formula $\M{\mathcal{M}}^{(pp)}$
\end_inset


\change_inserted -1422339205 1510610734
 (equal to the diagonal block of 
\begin_inset Formula $\M{\mathcal{M}}$
\end_inset

 corresponding to body 
\begin_inset Formula $p$
\end_inset

)
\change_unchanged
, ignoring the presence of other bodies.
 The preconditioner for the Lanczos method is a block diagonal matrix 
\change_inserted -1422339205 1510610734

\begin_inset Formula $\M L=\aMob^{\frac{1}{2}}$
\end_inset


\change_unchanged
 composed of the Cholesky factors of 
\change_deleted -1931946903 1510607918

\begin_inset Formula $\widehat{\M M}_{p}$
\end_inset


\change_inserted -1931946903 1510607918

\begin_inset Formula $\M{\mathcal{M}}^{(pp)}$
\end_inset


\change_unchanged
.
 We pre-compute 
\begin_inset Formula $\M L$
\end_inset

 once per time step (or less frequently if desired) and then reuse it in
 the iterative solves in that time step.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
 
\begin_inset Graphics
	filename figures/ResidualLancozBoomerangs.eps
	width 75text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:BoomResidual"

\end_inset

Convergence of iterative solvers for the problem described in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ManyBooms"

\end_inset

, a suspension of 256, 1024 or 4096 colloidal boomerangs (each containing
 15 blobs) sedimented near a bottom wall.
 Convergence of the preconditioned GMRES iteration to solve equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

), labeled as `Rigid solve', is demarcated by solid lines.
 Convergence of the preconditioned Lanczos method to compute 
\begin_inset Formula $\Mob^{1/2}\V W$
\end_inset

, labeled as 'PC Lanczos', is demarcated by filled symbols, while the correspond
ing results without preconditioning, labeled as 'un-PC Lanczos', are demarcated
 by un-filled symbols.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\change_inserted -1422339205 1510955359
In Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:BoomResidual"

\end_inset

 w
\change_inserted 2030352201 1510930072
e probe the convergence of our preconditioned solvers in a suspension of
 boomerang colloidal particles sedimented over a rigid wall 
\change_inserted -1422339205 1510950452
for
\change_deleted -1422339205 1510950451
at
\change_inserted 2030352201 1510930072
 
\change_inserted -1422339205 1510950449
surface 
\change_inserted 2030352201 1510930072
area fraction 
\begin_inset Formula $\phi\approx0.25$
\end_inset

 (see details in Sec.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Results"

\end_inset

).
 
\change_deleted -1422339205 1510950580
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:BoomResidual"

\end_inset


\change_inserted -1422339205 1510950582
The figure
\change_unchanged
 shows the number of iterations required to reach a desired tolerance for
 both the solution of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

)
\change_inserted -1422339205 1510950590
,
\change_unchanged
 as well as 
\change_inserted -1422339205 1510950597
for computing 
\change_unchanged
the product 
\begin_inset Formula $\Mob^{1/2}\V W$
\end_inset


\change_inserted -1422339205 1510950601
,
\change_unchanged
 for 
\change_inserted -1422339205 1510950604
three 
\change_unchanged
different problem sizes.
 Also shown is the effect of preconditioning on the convergence of the matrix
 root computation.
 We can see that up to a relative tolerance of around 
\begin_inset Formula $10^{-3}$
\end_inset

, both the saddle point solve, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

) and 
\begin_inset Formula $\Mob^{1/2}\V W$
\end_inset

 require roughly the same number of iterations to converge, with the latter
 taking more iterations when smaller tolerances are required.
 When preconditioning is used, both iterative methods are shown to have
 convergence rates independent of problem size.
 Nevertheless, computing matrix roots represents another major bottleneck
 in integrating (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

) for rigid multiblobs confined above a no-slip floor, with cost similar
 to that of solving the saddle point system (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:saddle"

\end_inset

).
 Observe that both the computation of the deterministic and the fluctuating
 velocities involves repeated applications of 
\begin_inset Formula $\Mob$
\end_inset

, which dominates the cost.
 Therefore, we seek to integrate (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

) to a desired accuracy in as few total number of applications of 
\begin_inset Formula $\Mob$
\end_inset

 as possible.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:RFD"

\end_inset

Temporal Integrators and the Thermal Drift
\end_layout

\begin_layout Standard
Our goal is to numerically integrate the overdamped Langevin equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

) as efficiently as possible.
 In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BD"

\end_inset

 we discussed efficient means of computing 
\begin_inset Formula $\N\V F+\sqrt{2k_{B}T/\D t}\;\N^{1/2}\V W$
\end_inset

, all that remains is to find a way to efficiently generate the thermal
 drift term 
\begin_inset Formula $k_{B}T\ \partial_{\V Q}\cdot\N$
\end_inset

.
 
\change_inserted -1422339205 1510612620
Capturing this drift term is a common challenge in all methods for Brownian
 dynamics, and the methods developed here are general and apply to any approach
 based on solving mobility problems.
\change_unchanged

\end_layout

\begin_layout Standard
A widely-used method to capture 
\begin_inset Formula $k_{B}T\ \partial_{\V Q}\cdot\N$
\end_inset

 is due to Fixman 
\begin_inset CommandInset citation
LatexCommand cite
key "BD_Fixman"

\end_inset

, and can be seen as a midpoint method to capture the Stratonovich product
 in a mixed Stratonovich-Ito (also known as Klimontovich or kinetic interpretati
on 
\begin_inset CommandInset citation
LatexCommand cite
key "KineticStochasticIntegral_Ottinger"

\end_inset

) re-formulation of (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

) 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 The generalization of Fixman's method to account for particle orientations
 is given in Section III of 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 The problem with the Fixman scheme in the context of many-body suspensions
 is that it requires the computation of 
\begin_inset Formula $\N^{-1/2}\V W$
\end_inset

.
 This is related to solving resistance problems and is infeasible for many
 body simulations.
 In particular, there is no known method to compute 
\begin_inset Formula $\Mob^{-1}$
\end_inset

 which scales linearly with the problem size.
 Hence, the Fixman's scheme has to be ruled out for use in many body simulations.
 Here we will only use Fixman's method as a reference method for small problems
 involving at most on the order of a hundred blobs, where dense linear algebra
 is practicable 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand cite
key "MultiscaleIntegrators,BrownianMultiBlobs"

\end_inset

, some of us proposed a means of capturing the drift term in (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

) using a modification of Fixman's approach.
 This idea, termed random finite difference (RFD), is as follows.
 Given two Gaussian random vectors, 
\begin_inset Formula $\Delta\V P$
\end_inset

 and 
\begin_inset Formula $\Delta\V Q$
\end_inset

, such that 
\begin_inset Formula $\av{\Delta\V P\Delta\V Q^{T}}=\left(k_{B}T\right)\M I$
\end_inset

, the following relation holds for a configuration dependent matrix 
\begin_inset Formula $\sM B\left(\V Q\right)$
\end_inset

, 
\begin_inset Formula 
\begin{align}
 & \lim_{\delta\rightarrow0}\frac{1}{\delta}\av{\left\{ \sM B\left(\V Q+\delta\Delta\V Q\right)-\sM B\left(\V Q\right)\right\} \Delta\V P}=\label{eq:RFDoneside}\\
 & \lim_{\delta\rightarrow0}\frac{1}{\delta}\av{\left\{ \sM B\left(\V Q+\frac{\delta}{2}\Delta\V Q\right)-\sM B\left(\V Q-\frac{\delta}{2}\Delta\V Q\right)\right\} \Delta\V P}=\label{eq:RFDcenter}\\
 & \left\{ \partial_{\V Q}\sM B\left(\V Q\right)\right\} \colon\av{\Delta\V P\Delta\V Q^{T}}=k_{B}T\,\partial_{\V Q}\cdot\sM B\left(\V Q\right),\label{eq:RFDB}
\end{align}

\end_inset

where 
\begin_inset Formula $\av{}$
\end_inset

 denotes an ensemble average.
 In practice, we will implement random finite differences by simply taking
 
\begin_inset Formula $\delta$
\end_inset

 to be a 
\shape italic
small
\shape default
 number.
 Thus we recognize, by analogy with standard finite differences, equations
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDoneside"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDcenter"

\end_inset

 as one-sided and centered approximations to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDB"

\end_inset

 with truncation errors of 
\begin_inset Formula $O\left(\delta\right)$
\end_inset

 and 
\begin_inset Formula $O\left(\delta^{2}\right)$
\end_inset

 respectively.
 Note that Fixman's scheme can be viewed as an RFD where 
\begin_inset Formula $\delta=\sqrt{\Delta t}$
\end_inset

, 
\begin_inset Formula $\sM B=\N$
\end_inset

, 
\begin_inset Formula $\Delta\V Q=\sqrt{k_{B}T}\N^{1/2}\V W$
\end_inset

, and 
\begin_inset Formula $\Delta\V P=\sqrt{k_{B}T}\N^{-1/2}\V W$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "MultiscaleIntegrators"

\end_inset


\change_inserted -1422339205 1510611610
; see Section III.D in 
\begin_inset CommandInset citation
LatexCommand cite
key "StokesianDynamics_Brownian"

\end_inset

 for the first use of a 
\begin_inset Formula $\delta$
\end_inset

 independent of 
\begin_inset Formula $\D t$
\end_inset

 in order to 
\begin_inset Quotes eld
\end_inset

avoid particle 'overlaps' in the intermediate configuration.
\begin_inset Quotes erd
\end_inset


\change_deleted -1422339205 1510612014
.

\change_unchanged
 A simpler choice, used in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs,MagneticRollers"

\end_inset

, is to take 
\begin_inset Formula $\sM B=\N$
\end_inset

, and use 
\begin_inset Formula $\Delta\V P=\Delta\V Q=\sqrt{k_{B}T}\,\V W$
\end_inset

.

\change_inserted -1422339205 1510611808
 Other more efficient choices have been constructed in a number of specific
 contexts 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs,PSE_Stresslets,FluctuatingFCM_DC"

\end_inset

.

\change_unchanged
 In order to best pick 
\begin_inset Formula $\delta$
\end_inset

, we must balance the truncation error with other sources of error introduced
 from the inexact multiplication of 
\begin_inset Formula $\sM B$
\end_inset

.
 At best, multiplication by 
\begin_inset Formula $\sM B$
\end_inset

 is calculated to machine precision and 
\begin_inset Formula $\delta$
\end_inset

 may be taken to be quite small.
 At worst, multiplication of 
\begin_inset Formula $\sM B$
\end_inset

 is only computed approximately to within some relative tolerance 
\begin_inset Formula $\epsilon$
\end_inset

, as would be the case when we take 
\begin_inset Formula $\sM B=\N$
\end_inset

 and matrix vector multiplications are computed using the iterative method
 described in section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:multN"

\end_inset

.
 In this case, using one-sided differencing can lead to large truncation
 errors when loose solver tolerances are used, and we recommend that only
 central differencing be used.
 
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

, an Euler-Maruyama (EM) RFD (EM-RFD) scheme is presented to solve 
\begin_inset CommandInset ref
LatexCommand eqref
reference "Langevin"

\end_inset

, using a one-sided RFD on 
\begin_inset Formula $\N$
\end_inset

.
 A scalable variant of this using a central RFD is a trivial extension summarize
d in appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "add:EMrfd"

\end_inset

, where we clarify how to do this using iterative solvers and also with
 care for different units for length and orientation.
 This scheme requires 
\emph on
three
\emph default
 solutions of the saddle point system 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:saddle"

\end_inset

 and one application of 
\begin_inset Formula $\Mob^{1/2}$
\end_inset

 per timestep, and is only first-order accurate even deterministically.
 By using different choices for 
\begin_inset Formula $\Delta\V P$
\end_inset

 and 
\begin_inset Formula $\Delta\V Q$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDcenter"

\end_inset

, we will reduce the cost of capturing the stochastic drift term considerably.
 In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "Traction"

\end_inset

 we will present an EM Traction (EM-T) scheme which only requires 
\emph on
two
\emph default
 solutions of the saddle point system.
 The trapezoidal slip (T-S) scheme presented in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Slip"

\end_inset

 still requires three solutions of the saddle point system but achieves
 higher accuracy, notably, it is second-order accurate deterministically
 just like the Fixman midpoint scheme given in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 We will empirically compare these two schemes in terms of accuracy per
 computational effort in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ManyBooms"

\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "Traction"

\end_inset

Euler-Maruyama Traction (EM-T) Scheme
\end_layout

\begin_layout Standard
To improve the efficiency of the scheme given in appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "add:EMrfd"

\end_inset

, we propose a different means of computing the drift term.
 Using the chain rule, we can split the divergence of the body mobility
 matrix into three pieces, 
\begin_inset Formula 
\begin{align}
 & \partial_{\V Q}\cdot\N=-\N\left(\partial_{\V Q}\N^{-1}\right)\colon\N=-\N\left(\partial_{\V Q}\left\{ \K^{T}\Mob^{-1}\K\right\} \right)\colon\N=\label{DN}\\
 & -\N\left\{ \partial_{\V Q}\K^{T}\right\} \colon\Mob^{-1}\K\N-\N\K^{T}\left\{ \partial_{\V Q}\Mob^{-1}\right\} \colon\K\N-\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\K\right\} \colon\N=\nonumber \\
 & -\N\left\{ \partial_{\V Q}\K^{T}\right\} \colon\Mob^{-1}\K\N+\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\Mob\right\} \colon\Mob^{-1}\K\N-\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\K\right\} \colon\N.\nonumber 
\end{align}

\end_inset

where colon denotes contraction; this calculation is done more precisely
 using index notation in appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "Add:Quat"

\end_inset

.
 Unlike 
\begin_inset Formula $\N$
\end_inset

, we can efficiently compute the action of 
\begin_inset Formula $\K^{T}$
\end_inset

, 
\begin_inset Formula $\Mob$
\end_inset

, and 
\begin_inset Formula $\K$
\end_inset

, without the need for a linear solver 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In this paper, we evaluate the action of 
\begin_inset Formula $\Mob$
\end_inset

 directly using a summation on the GPU, which gives accuracy comparable
 to roundoff.
 But other more scalable implementations of the action of the RPY mobility
 would use approximate methods like the fast multipole method (FMM) 
\begin_inset CommandInset citation
LatexCommand cite
key "RPY_FMM,OseenBlake_FMM"

\end_inset

 or the Spectral Ewald method 
\begin_inset CommandInset citation
LatexCommand cite
key "SpectralRPY"

\end_inset

, which would have an input relative error tolerance of their own, larger
 than the roundoff error.
\end_layout

\end_inset

.
 Thus, we can use a random finite difference to compute the three derivatives
 
\begin_inset Formula $\partial_{\V Q}\K^{T}$
\end_inset

, 
\begin_inset Formula $\partial_{\V Q}\Mob$
\end_inset

, and 
\begin_inset Formula $\partial_{\V Q}\K$
\end_inset

 in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "DN"

\end_inset

) separately.
 When selecting the value of 
\begin_inset Formula $\delta$
\end_inset

 for these computations, we must balance the truncation error of the RFD
 (we will only consider centered differences) with the relative accuracy
 in computing the product of the operator (i.e 
\begin_inset Formula $\K$
\end_inset

, 
\begin_inset Formula $\Mob$
\end_inset

).
 If the matrix-vector products are computed directly, then we balance the
 truncation error with the machine precision and take 
\begin_inset Formula $\delta\sim10^{-3}$
\end_inset

 when single precision is used 
\begin_inset Foot
status open

\begin_layout Plain Layout
On many GPUs it is more efficient to use single-precision arithmetic.
\end_layout

\end_inset

, and 
\begin_inset Formula $\delta\sim10^{-6}$
\end_inset

 for double precision.
 However, if we only compute the action of 
\begin_inset Formula $\Mob$
\end_inset

 to within some relative accuracy 
\begin_inset Formula $\epsilon$
\end_inset

, as would be the case if we used the FMM or PSE method, we must take 
\begin_inset Formula $\delta\sim\epsilon^{1/3}$
\end_inset

.
\end_layout

\begin_layout Standard
To utilize equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "DN"

\end_inset

), we first generate random forces and torques for each body 
\begin_inset Formula $p$
\end_inset

 
\begin_inset Formula 
\begin{equation}
\V W_{p}^{FT}=k_{B}T\begin{bmatrix}L_{p}^{-1}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix},\label{eq:W_FT}
\end{equation}

\end_inset

where 
\begin_inset Formula $\V W_{p}^{f},\,\V W_{p}^{\tau}$
\end_inset

 are standard Guassian random vectors, and 
\begin_inset Formula $L_{p}$
\end_inset

 is a measure of the body length.
 Note the choice of length scale used in the blocks of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:W_FT"

\end_inset

 is to minimize the variance of the RFD estimate, as we explain in appendix
 
\begin_inset CommandInset ref
LatexCommand ref
reference "add:EMrfd"

\end_inset

.
 We then solve a mobility problem with random applied forces and torques
 
\begin_inset Formula $\V W^{FT}=\left[\V W_{p}^{FT}\right]$
\end_inset

, for both the random traction force 
\begin_inset Formula $\V{\lambda}^{\text{RFD}}$
\end_inset

, and the random rigid velocity 
\begin_inset Formula $\V U^{\text{RFD}}$
\end_inset

, 
\begin_inset Formula 
\begin{align}
\V{\lambda}^{\text{RFD}} & =\Mob^{-1}\K\N\ \V W^{FT}\\
\V U^{\text{RFD}} & =\N\ \V W^{FT}.
\end{align}

\end_inset

To compute the relevant random finite difference terms, we randomly displace
 the particles to 
\begin_inset Formula $\V Q^{\pm}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\V Q_{p}^{\pm}=\V Q_{p}\pm\frac{\delta}{2}\Delta\V Q_{p}=\V Q_{p}\pm\frac{\delta}{2}\begin{bmatrix}L_{p}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}.
\end{equation}

\end_inset

Using this and equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "DN"

\end_inset

, we are able to compute the necessary drift term using random finite difference
s as 
\begin_inset Formula 
\begin{align}
\text{Drift}= & -\frac{1}{\delta}\N\left\{ \K^{T}(\V Q^{+})-\K^{T}(\V Q^{-})\right\} \ \V{\lambda}^{\text{RFD}}\label{eq:traction}\\
 & +\frac{1}{\delta}\N\K^{T}\Mob^{-1}\left\{ \Mob(\V Q^{+})-\Mob(\V Q^{-})\right\} \ \V{\lambda}^{\text{RFD}}\nonumber \\
 & -\frac{1}{\delta}\N\K^{T}\Mob^{-1}\left\{ \K(\V Q^{+})-\K(\V Q^{-})\right\} \ \V U^{\text{RFD}}\nonumber \\
\approx & \biggl(-\N\left\{ \partial_{\V Q}\K^{T}\right\} \Mob^{-1}\K\N\nonumber \\
 & +\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\Mob\right\} \Mob^{-1}\K\N\nonumber \\
 & -\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\K\right\} \N\biggl):\left[\V W^{FT}\ \left(\Delta\V Q\right)^{T}\right]\nonumber \\
= & \partial_{\V Q}\N:\left[\V W^{FT}\ \left(\Delta\V Q\right)^{T}\right],\nonumber 
\end{align}

\end_inset

where all operators and derivatives are evaluated at the same point 
\begin_inset Formula $\V Q$
\end_inset

 unless otherwise noted
\change_inserted -1931946903 1510607701
 and 
\begin_inset Formula $\left(\Delta\V Q\right)^{T}$
\end_inset

 denotes the transpose of 
\begin_inset Formula $\Delta\V Q$
\end_inset


\change_unchanged
.
 Hence, in expectation, we have 
\begin_inset Formula 
\begin{equation}
\left\langle \text{Drift}\right\rangle \approx k_{B}T\ \partial_{\V Q}\cdot\N.
\end{equation}

\end_inset

This computation is detailed in index notation, accounting for the constrained
 quaternion representation of orientations, in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "Add:tractionDense"

\end_inset

.
\end_layout

\begin_layout Standard
To leading order in 
\begin_inset Formula $\delta$
\end_inset

, the method of computing the drift proposed in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:traction"

\end_inset

, termed the 
\shape italic
traction-corrected
\shape default
 RFD, is equivalent to the direct RFD on 
\begin_inset Formula $\N$
\end_inset

 used in appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "add:EMrfd"

\end_inset

 when exact linear algebra is used.
 However, using the traction-corrected RFD allows the use of inexact, iterative
 mobility solvers, without incurring additional restrictions on the small
 parameter 
\begin_inset Formula $\delta$
\end_inset

 from the prescribed solver tolerance.
 Furthermore, we are able to capture the drift term in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

) with only two saddle point solves rather than the three required if we
 were to use an RFD on 
\begin_inset Formula $\N$
\end_inset

 directly.
 Our Euler-Maruyama Traction (EM-T) Scheme is summarized in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

, and is analyzed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "Add:tractionDense"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:traction"

\end_inset

 Euler-Maruyama Traction (EM-T) Scheme
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:TracStep1"

\end_inset

Compute relevant quantities for capturing drift:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Form 
\begin_inset Formula $\V W^{FT}=\left[\V W_{p}^{FT}\right],$
\end_inset

 where 
\begin_inset Formula 
\[
\V W_{p}^{FT}=k_{B}T\begin{bmatrix}L_{p}^{-1}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}
\]

\end_inset

and 
\begin_inset Formula $\V W_{p}^{f},\,\V W_{p}^{\tau}$
\end_inset

 are standard Gaussian random vectors.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:ULam"

\end_inset

Solve RFD mobility problem:
\begin_inset Formula 
\[
\begin{bmatrix}\Mob^{n} & -\K^{n}\\
-\left(\K^{T}\right)^{n} & \V 0
\end{bmatrix}\begin{bmatrix}\V{\lambda}^{\text{RFD}}\\
\V U^{\text{RFD}}
\end{bmatrix}=\begin{bmatrix}0\\
-\V W^{FT}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:URFD"

\end_inset

Randomly displace particles to:
\begin_inset Formula 
\[
\V Q_{p}^{\pm}=\V Q_{p}^{n}+\frac{\delta}{2}\begin{bmatrix}L_{p}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:DFDS"

\end_inset

Compute the force-drift, 
\begin_inset Formula $\V D^{F}$
\end_inset

, and the slip-drift, 
\begin_inset Formula $\V D^{S}$
\end_inset

:
\begin_inset Formula 
\begin{align*}
\V D^{F} & =\frac{1}{\delta}\left\{ \K^{T}\left(\V Q^{+}\right)-\K^{T}\left(\V Q^{-}\right)\right\} \V{\lambda}^{\text{RFD}}\\
\V D^{S} & =\frac{1}{\delta}\left\{ \Mob\left(\V Q^{+}\right)-\Mob\left(\V Q^{-}\right)\right\} \V{\lambda}^{\text{RFD}}-\frac{1}{\delta}\left\{ \K\left(\V Q^{+}\right)-\K\left(\V Q^{-}\right)\right\} \V U^{\text{RFD}}.
\end{align*}

\end_inset

Note that different 
\begin_inset Formula $\delta$
\end_inset

 may be used for the RFDs on 
\begin_inset Formula $\K$
\end_inset

 and 
\begin_inset Formula $\Mob$
\end_inset

 depending on the relative accuracy with which the action of 
\begin_inset Formula $\Mob$
\end_inset

 is evaluated.
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:MhalfEM"

\end_inset

Compute 
\begin_inset Formula $\left(\Mob^{1/2}\right)^{n}\V W^{n}$
\end_inset

 using a preconditioned Lancoz method or PSE.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:Udef"

\end_inset

Evaluate forces and torques at 
\begin_inset Formula $\V F^{n}=\V F\left(\V Q^{n},\,t\right)$
\end_inset

 and solve the mobility problem:
\begin_inset Formula 
\[
\begin{bmatrix}\Mob^{n} & -\K^{n}\\
-\left(\K^{T}\right)^{n} & \V 0
\end{bmatrix}\begin{bmatrix}\V{\lambda}^{n}\\
\V U^{n}
\end{bmatrix}=\begin{bmatrix}-\V D^{S}-\sqrt{2k_{B}T/\D t}\left(\Mob^{1/2}\right)^{n}\V W^{n}\\
-\V F^{n}+\V D^{F}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:U"

\end_inset

 Update configurations to time 
\begin_inset Formula $t+\D t$
\end_inset

:
\begin_inset Formula 
\[
\V Q^{n+1}=\V Q^{n}+\Delta t\V U^{n}.
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec:Slip"

\end_inset

Trapezoidal Slip (T-S) Scheme
\end_layout

\begin_layout Standard
In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "Traction"

\end_inset

, we developed a method to efficiently and accurately generate the necessary
 drift term in an Euler-Maruyama scheme.
 However, when second order deterministic accuracy is desired, we may wish
 to use a midpoint or trapezoidal scheme 
\begin_inset CommandInset citation
LatexCommand cite
key "MultiscaleIntegrators"

\end_inset

.
 Some higher order methods, however, will generate additional drift terms
 due to the Brownian increment being evaluated at multiple time levels.
 As an example, consider a naive two-solve implementation of the trapezoidal
 scheme:
\begin_inset Formula 
\begin{align}
\widetilde{\V Q}= & \V Q^{n}+\D t\N^{n}\V F^{n}+\sqrt{2\D tk_{B}T}\left(\N\K^{T}\Mob^{-1}\right)^{n}\left(\Mob^{1/2}\right){}^{n}\ \V W^{n}\label{eq:IncTrap1}\\
\V Q^{n+1}= & \V Q^{n}+\frac{\D t}{2}\left(\N^{n}\V F^{n}+\aN\widetilde{\V F}\right)\label{eq:IncTrap2}\\
+ & \sqrt{\frac{\D tk_{B}T}{2}}\left\{ \left(\N\K^{T}\Mob^{-1}\right)^{n}+\aN\aK^{T}\aMob^{-1}\right\} \left(\Mob^{1/2}\right){}^{n}\ \V W^{n},\nonumber 
\end{align}

\end_inset

where superscripts and tildes indicate the point at which quantities are
 evaluated, e.g., 
\begin_inset Formula $\aN\equiv\N\left(\widetilde{\V Q}\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
As shown in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "Add:SlipDense"

\end_inset

, the thermal drift produced by the final velocity update in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IncTrap2"

\end_inset

 (in expectation) is 
\begin_inset Formula 
\begin{equation}
\left\langle \text{\text{Drift part 1}}\right\rangle =\av{\frac{\V Q^{n+1}-\V Q^{n}}{\D t}}\approx\left(k_{B}T\right)\ \N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\K\right\} \colon\N,\label{eq:trapdrift}
\end{equation}

\end_inset

We recognize this as the third term in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "DN"

\end_inset

) and hence, we may use it to generate the full, desired drift.
 Examining equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "DN"

\end_inset

) reveals that we must generate the remaining two terms 
\begin_inset Formula 
\begin{equation}
-\N\left\{ \partial_{\V Q}\K^{T}\right\} \colon\Mob^{-1}\K\N+\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\Mob\right\} \colon\Mob^{-1}\K\N,\label{eq:TrapTerms}
\end{equation}

\end_inset

in order to capture the desired drift.
\end_layout

\begin_layout Standard
In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "Traction"

\end_inset

, we generated random traction forces of the form 
\begin_inset Formula $\Mob^{-1}\K\N\V W^{FT}$
\end_inset

, and used these as the 
\begin_inset Formula $\D{\V P}$
\end_inset

 in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:RFDB"

\end_inset

) to compute a traction-corrected RFD approximation to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:TrapTerms"

\end_inset

.
 Here we propose a different 
\emph on
slip-corrected
\emph default
 RFD method to compute the two terms in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:TrapTerms"

\end_inset

.
 For each body, we generate a vector of random blob displacements 
\begin_inset Formula $\slipW^{D}=\left[L_{p}\V W_{p}^{s}\right]$
\end_inset

, and random blob forces 
\begin_inset Formula $\slipW^{F}=\left[\frac{k_{B}T}{L_{p}}\V W_{p}^{s}\right],$
\end_inset

 where 
\begin_inset Formula $L_{p}$
\end_inset

 is a length scale for body 
\begin_inset Formula $p$
\end_inset

, and 
\begin_inset Formula $\V W^{s}$
\end_inset

 is a random Gaussian vector.
 We may then compute rigid body displacements, 
\begin_inset Formula $\D{\V Q^{\text{RFD}}}=\N\K^{T}\Mob^{-1}\slipW^{D}$
\end_inset

, which may be used as 
\begin_inset Formula $\D{\V Q}$
\end_inset

 in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:RFDB"

\end_inset

) to compute an RFD approximation to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:TrapTerms"

\end_inset

.
 That is, we may approximate the missing drift terms 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:TrapTerms"

\end_inset

 by computing
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout

\color green
The last line is probably fine as it is written, but it's missing that there
 will be blocks like 
\begin_inset Formula $\frac{L_{1}}{L_{2}}\V W_{2}^{s}\left(\V W_{1}^{s}\right)^{T}$
\end_inset

 which have mean zero but contribute to the variance of the RFD
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\text{Drift part 2}= & -\frac{1}{\delta}\N\left\{ \K^{T}(\V Q^{+})-\K^{T}(\V Q^{-})\right\} \ \slipW^{F}\label{eq:slip}\\
 & +\frac{1}{\delta}\N\K^{T}\Mob^{-1}\left\{ \Mob(\V Q^{+})-\Mob(\V Q^{-})\right\} \ \slipW^{F}\nonumber \\
\approx & \left(-\N\left\{ \partial_{\V Q}\K^{T}\right\} +\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\Mob\right\} \right)\colon\left[\slipW^{F}\ \left(\D{\V Q^{\text{RFD}}}\right)^{T}\right]\nonumber \\
= & \left(k_{B}T\right)\left(-\N\left\{ \partial_{\V Q}\K^{T}\right\} +\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\Mob\right\} \right)\colon\Mob^{-1}\K\N\left[\V W^{s}\left(\V W^{s}\right)^{T}\right],\nonumber 
\end{align}

\end_inset

where as before 
\begin_inset Formula $\V Q_{p}^{\pm}=\V Q_{p}\pm\frac{\delta}{2}\D{\V Q_{p}^{\text{RFD}}}$
\end_inset

.
 Hence, in expectation we obtain the missing drift terms 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:TrapTerms"

\end_inset

, 
\begin_inset Formula 
\[
\left\langle \text{\text{Drift part 2}}\right\rangle \approx k_{B}T\left(-\N\left\{ \partial_{\V Q}\K^{T}\right\} \colon\Mob^{-1}\K\N+\N\K^{T}\Mob^{-1}\left\{ \partial_{\V Q}\Mob\right\} \colon\Mob^{-1}\K\N\right),
\]

\end_inset

which combined with (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:trapdrift"

\end_inset

) gives us the desired drift 
\begin_inset Formula $k_{B}T\ \partial_{\V Q}\cdot\N$
\end_inset

.
\end_layout

\begin_layout Standard
Our Trapezoidal Slip (T-S) scheme is summarized in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

, and is analyzed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "Add:SlipDense"

\end_inset

.
 It involves three mobility solves and one Lanczos computation per time
 step, just like the EM-RFD scheme given in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RFDN"

\end_inset

, however, T-S is second order deterministically just like the Fixman midpoint
 scheme.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:sliptrap"

\end_inset

 Trapezoidal Slip (T-S) scheme
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Compute relevant quantities for capturing drift:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Generate random Gaussian directions 
\begin_inset Formula $\V W^{s}$
\end_inset

 for each blob, and form the composite vectors of blob displacements 
\begin_inset Formula $\slipW^{D}=\left[L_{p}\V W_{p}^{s}\right]$
\end_inset

 and blob forces 
\begin_inset Formula $\slipW^{F}=\left[\frac{k_{B}T}{L_{p}}\V W_{p}^{s}\right]$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:UrfdT"

\end_inset

Solve RFD mobility (more precisely, displacement) problem:
\begin_inset Formula 
\[
\begin{bmatrix}\Mob^{n} & -\K^{n}\\
-\left(\K^{T}\right)^{n} & \V 0
\end{bmatrix}\begin{bmatrix}\V{\lambda}^{\text{RFD}}\\
\D{\V Q^{\text{RFD}}}
\end{bmatrix}=\begin{bmatrix}-\slipW^{D}\\
0
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:QpmT"

\end_inset

Randomly displace particles to 
\begin_inset Formula $\V Q^{\pm}$
\end_inset

:
\begin_inset Formula 
\[
\V Q^{\pm}=\V Q^{n}\pm\frac{\delta}{2}\D{\V Q^{\text{RFD}}}
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:DFDS2"

\end_inset

Compute the force-drift, 
\begin_inset Formula $\V D^{F}$
\end_inset

, and the slip-drift, 
\begin_inset Formula $\V D^{S}$
\end_inset

, where:
\begin_inset Formula 
\begin{align*}
\V D^{F} & =\frac{1}{\delta}\left\{ \K^{T}\left(\V Q^{+}\right)-\K^{T}\left(\V Q^{-}\right)\right\} \slipW^{F},\\
\V D^{S} & =\frac{1}{\delta}\left\{ \Mob\left(\V Q^{+}\right)-\Mob\left(\V Q^{-}\right)\right\} \slipW^{F}.
\end{align*}

\end_inset

Note that different 
\begin_inset Formula $\delta$
\end_inset

 may be used for the two RFDs depending on the relative accuracy with which
 the action of 
\begin_inset Formula $\Mob$
\end_inset

 is evaluated.
\end_layout

\end_deeper
\begin_layout Enumerate
Compute 
\begin_inset Formula $\left(\Mob^{1/2}\right)^{n}\V W^{n}$
\end_inset

 using a preconditioned Lancoz method or PSE.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:unT"

\end_inset

Evaluate forces and torques at 
\begin_inset Formula $\V F^{n}=\V F\left(\V Q^{n},\,t\right)$
\end_inset

 and solve predictor mobility problem:
\begin_inset Formula 
\[
\begin{bmatrix}\Mob^{n} & -\K^{n}\\
-\left(\K^{T}\right)^{n} & \V 0
\end{bmatrix}\begin{bmatrix}\V{\lambda}^{n}\\
\V U^{n}
\end{bmatrix}=\begin{bmatrix}-\sqrt{2k_{B}T/\D t}\left(\Mob^{1/2}\right)^{n}\V W^{n}\\
-\V F^{n}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:Qtil"

\end_inset

Update configurations to predicted position 
\begin_inset Formula $\widetilde{\V Q}$
\end_inset

:
\begin_inset Formula 
\[
\widetilde{\V Q}=\V Q^{n}+\D t\V U^{n}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:unp1T"

\end_inset

Evaluate forces and torques at 
\begin_inset Formula $\widetilde{\V F}=\V F\left(\widetilde{\V Q},\,t\right)$
\end_inset

 and solve corrector mobility problem at the predicted position 
\begin_inset Formula $\widetilde{\V Q}$
\end_inset

:
\begin_inset Formula 
\[
\begin{bmatrix}\aMob & -\aK\\
-\aK^{T} & \V 0
\end{bmatrix}\begin{bmatrix}\widetilde{\V{\lambda}}\\
\widetilde{\V U}
\end{bmatrix}=\begin{bmatrix}-2\V D^{S}-\sqrt{\frac{2k_{B}T}{\Delta t}}(\Mob^{1/2})^{n}\V W^{n}\\
-\widetilde{\V F}+2\V D^{F}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "step:unun1"

\end_inset

Update configurations to corrected position 
\begin_inset Formula $\V Q^{n+1}$
\end_inset

:
\begin_inset Formula 
\[
\V Q^{n+1}=\V Q^{n}+\frac{\D t}{2}\left(\V U^{n}+\widetilde{\V U}\right).
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is important to point out that by using either the traction-corrected
 RFD (i.e., applying random uncorrelated forces and torques on the particles)
 or the slip-corrected RFD (i.e., applying random uncorrelated slip on the
 particles' surfaces), one can construct a multitude of schemes that give
 the desired stochastic drift term in expectation for sufficiently small
 
\begin_inset Formula $\D t$
\end_inset

.
 For example, an alternative method to generate the remaining drift terms
 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:TrapTerms"

\end_inset

, while still using the trapezoidal rule, would be to compute 
\begin_inset Formula $\V D^{S}$
\end_inset

 and 
\begin_inset Formula $\V D^{F}$
\end_inset

 analogous to step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:TracStep1"

\end_inset

 of algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

 but without the term involving 
\begin_inset Formula $\V U^{\text{RFD}}$
\end_inset

 (which is already included via the trapezoidal corrector step).
 In numerical tests, we have found such a Trapezoidal Traction (T-T) scheme
 to perform very similarly to the (T-S) scheme for all solver tolerances
 and time step sizes examined.
 We also examined midpoint variants 
\begin_inset CommandInset citation
LatexCommand cite
key "DFDB"

\end_inset

 of the (T-T) and (T-S) schemes, both of which require an additional application
 of 
\begin_inset Formula $\Mob^{1/2}$
\end_inset

 in the corrector step, and found them to be inferior in terms of cost-accuracy
 balance than the T-S scheme presented here 
\begin_inset Foot
status open

\begin_layout Plain Layout
The midpoint slip scheme was much more robust than the midpoint traction
 scheme for larger 
\begin_inset Formula $\D t$
\end_inset

.
\end_layout

\end_inset

.
 Modifications of the ideas presented in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "Traction"

\end_inset

 can be used to write a second order Adams-Bashforth traction (AB-T) scheme,
 in which the second-order AB multistep rule is used for the deterministic
 terms, while the drift term is computed analogously to the EM-T scheme
 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
 We found, however, that the AB-T scheme was inferior in accuracy compared
 to the T-S scheme, especially for larger 
\begin_inset Formula $\D t$
\end_inset

.
\end_layout

\begin_layout Section
Results
\begin_inset CommandInset label
LatexCommand label
name "sec:Results"

\end_inset


\end_layout

\begin_layout Standard
In this section, we study the accuracy and efficiency of the numerical schemes
 presented in sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "Traction"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Slip"

\end_inset

 for suspensions of rigid particles sedimented above a no-slip bottom wall.
 As mentioned in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Nhalf"

\end_inset

, the bottom wall acts to screen the hydrodynamic interactions, thereby
 reducing the number of iterations required for iterative methods to converge
 to a desired tolerance 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers,RigidMultiblobs"

\end_inset

.
 To prevent unphysical particle overlaps with the wall due to the Brownian
 motion, we include a soft repulsive wall-particle potential, and employ
 a regularized form of the blob-blob mobility which ensures that 
\begin_inset Formula $\Mob$
\end_inset

 is SPD and physical even when some blobs overlap the wall 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
\end_layout

\begin_layout Standard
In sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:WeakAccuracy"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ManyBooms"

\end_inset

, we investigate the weak accuracy of our methods on suspensions of colloidal
 right-angle "boomerangs".
 Colloidal boomerangs have been manufactured using lithography 
\begin_inset CommandInset citation
LatexCommand cite
key "BoomerangDiffusion"

\end_inset

, and the diffusion of a single boomerang above a wall was studied numerically
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 We will model a colloidal boomerang as an L-shaped body composed of 15
 blobs, with each `arm' of the boomerang being composed of 7 blobs in straight
 line, plus a common eighth blob shared by both arms, see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Booms"

\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

 it was found that blobs centers should be spaced approximately a distance
 of 
\begin_inset Formula $a$
\end_inset

 apart, where 
\begin_inset Formula $a$
\end_inset

 is the hydrodynamic radius of a blob.
 Although geometrically simple, boomerangs do not have spherical, axial,
 or skew symmetry and therefore proper treatment of orientations is essential
 to correctly model colloidal diffusion 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 In subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:TwoBooms"

\end_inset

, we study two colloidal boomerangs connected by an elastic string.
 The small problem size allows us to reduce sampling (statistical) errors
 enough to accurately measure temporal accuracy, and also to compare the
 schemes developed in this work to Fixman's scheme 
\begin_inset CommandInset citation
LatexCommand cite
key "BD_Fixman"

\end_inset

, which requires dense linear algebra to be used.
 In subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ManyBooms"

\end_inset

 we examine a suspension of many boomerangs to more effectively asses
\change_inserted 2030352201 1510929199
s
\change_unchanged
 the accuracy-efficiency tradeoff for the schemes developed here.
\end_layout

\begin_layout Standard
In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BrownRoll"

\end_inset

, we revisit some of the computational investigations reported in 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers,NonlocalShocks_Rollers"

\end_inset

 for active suspensions of rotating colloids 
\begin_inset CommandInset citation
LatexCommand cite
key "Rollers_NaturePhys,NonlocalShocks_Rollers"

\end_inset

.
 In these suspensions thermal motion sets the equilibrium gravitational
 height of the colloids, and it is necessary to include Brownian motion
 to enable quantitative comparisons to experiments 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers,NonlocalShocks_Rollers"

\end_inset

.
 At the same time, previous studies 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers,NonlocalShocks_Rollers"

\end_inset

 used a minimally-resolved representation of the hydrodynamics, with each
 particle represented by a single blob.
 This is not quantitatively accurate when the microrollers are close to
 the wall or other colloids, as in recent experiments 
\begin_inset CommandInset citation
LatexCommand cite
key "Rollers_NaturePhys,NonlocalShocks_Rollers"

\end_inset

.
 We represent the spheres using either 12 or 42 blobs 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

 in order to improve the accuracy of the hydrodynamic interactions, and
 choose 
\begin_inset Formula $a$
\end_inset

 as roughly half the distance between vertices in the multiblob sphere model
 following the recommendations in Sections IV and V of 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/Boom_Cross_Diagram_Cool_anotated.png
	lyxscale 50
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/Many_Booms_aut_crop.png
	lyxscale 40
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Booms"

\end_inset

Illustrations of the test problems involving colloidal boomerangs.
 (Top panel) Sample configuration of a boomerang dimer for the numerical
 experiments conducted in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:TwoBooms"

\end_inset

.
 (Bottom panel) Sample configuration of a boomerang suspension for the numerical
 experiments conducted in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ManyBooms"

\end_inset

.
 The shaded area is the part of the bottom wall that belongs to the central
 unit cell used for the pseudo-periodic boundary conditions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "subsec:WeakAccuracy"

\end_inset

Weak accuracy for a dimer of boomerangs
\end_layout

\begin_layout Standard
In this section we examine the equilibrium dynamics of a boomerang dimer
 formed from two colloidal boomerangs connected by a harmonic spring, as
 illustrated in the top panel of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Booms"

\end_inset

.
 The form of the potential connecting the two boomerangs is 
\begin_inset Formula 
\begin{equation}
U_{\text{\text{spring}}}(d)=\frac{\kappa}{2}\left(d-l_{0}\right)^{2},
\end{equation}

\end_inset

where 
\begin_inset Formula $d$
\end_inset

 is the distance between the two boomerang's 
\begin_inset Quotes eld
\end_inset

cross-points
\begin_inset Quotes erd
\end_inset

 (the elbow of the L-shaped bodies), 
\begin_inset Formula $l_{0}$
\end_inset

 is a rest length, and 
\begin_inset Formula $\kappa$
\end_inset

 is the spring constant.
 The steric interactions of the individual blobs are captured through a
 repulsive Yukawa potential, 
\begin_inset Formula 
\begin{equation}
U_{\text{steric}}(r)=\gamma\frac{e^{-r/b}}{r},
\end{equation}

\end_inset

where 
\begin_inset Formula $b$
\end_inset

 is the Debye length and 
\begin_inset Formula $\gamma$
\end_inset

 is the repulsion strength.
 This Yukawa potential potential is also used for the steric interactions
 of the bodies with the wall.
 In this section, we take 
\begin_inset Formula $l_{0}=1\mu\text{m}$
\end_inset

, 
\begin_inset Formula $\gamma=\kappa=0.096\frac{\text{m\text{g}}}{\text{s}^{2}}$
\end_inset

, and 
\begin_inset Formula $b=0.162\mu\text{m}$
\end_inset

.
 We will take the blob radius to be 
\begin_inset Formula $a=0.324\mu$
\end_inset

m and each blob will have a buoyant (excess) mass 
\begin_inset Formula $m_{e}=1.57\times10^{-11}$
\end_inset

mg, giving a net gravitational force 
\begin_inset Formula $m_{e}g$
\end_inset

 on each blob, where 
\begin_inset Formula $g=9.81\frac{\text{m}}{\text{s}^{2}}$
\end_inset

.
 The total force and torque on each body are computed by adding contributions
 of the spring, gravity, and steric repulsion over all the blobs comprising
 the body 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

.
 The bodies are suspended in water, 
\begin_inset Formula $\eta=1$
\end_inset

 mPa
\begin_inset Formula $\cdot$
\end_inset

s, at approximately room temperature, 
\begin_inset Formula $T=300$
\end_inset

K.
 In these investigations, we nondimensionalize the time step using the diffusive
 time scale for a single blob,
\begin_inset Formula 
\[
\D{\tau}=\frac{k_{B}T}{6\pi\eta a^{3}}\D t.
\]

\end_inset


\end_layout

\begin_layout Standard
In the absence of non-conservative forces (i.e., for passive suspensions),
 the equilibrium distribution for the particles' configuration is the familiar
 Gibbs-Boltzmann (GB) distribution
\begin_inset Formula 
\[
P_{\text{eq}}\left(\V Q\right)=P_{\text{GB}}\left(\V Q\right)=Z^{-1}\,\exp\left(-U\left(\V Q\right)/k_{B}T\right),
\]

\end_inset

where 
\begin_inset Formula $U\left(\V Q\right)$
\end_inset

 is the conservative potential from which the external forces and torques
 are obtained.
 As demonstrated in our prior work 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs,BrownianMultiBlobs"

\end_inset

, failure to consistently include the stochastic drift term in BD simulations
 leads to strong deviations from 
\begin_inset Formula $P_{\text{GB}}\left(\V Q\right)$
\end_inset

 in the presence of confinement.
 Therefore, a strong test that our methods are consistent with the overdamped
 Langevin equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "Langevin"

\end_inset

) is to examine how closely they reproduce (marginals of) the GB equilibrium
 distribution, as we do in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:TwoBooms"

\end_inset

.
 We use a Markov-chain Monte Carlo (MCMC) method to very accurately sample
 the GB equilibrium distribution and use this data to compute the error
 produced by each scheme.
 At the same time, it is important to also confirm that our schemes, unlike
 MCMC, correctly reproduce the 
\emph on
dynamics
\emph default
 of the particles even for time steps that are on the order of the diffusive
 time scale, as we do in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:MSD"

\end_inset

.
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sec:TwoBooms"

\end_inset

Static Accuracy
\end_layout

\begin_layout Standard
The stability limit for the EM-T scheme for the chosen parameters was empiricall
y estimated to be 
\begin_inset Formula $\D{\tau}\lesssim0.3$
\end_inset

.
 In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:CP"

\end_inset

 we study how well our numerical methods reproduce selected the Gibbs-Boltzmann
 equilibrium distribution for 
\begin_inset Formula $\D{\tau=0.072,\,0.144,\,0.288}$
\end_inset

.
 We have examined a number of marginals of the equilibrium distribution,
 but we focus here on the equilibrium distributions of the boomerang cross-point
 to cross-point distance.
 We use a relative tolerance of 
\begin_inset Formula $10^{-4}$
\end_inset

 in all iterative methods for the computations done in this section.
 An investigation into the effect of solver tolerance on the accuracy of
 the EM-T and T-S schemes showed no change in temporal accuracy for all
 solver tolerances less than or equal to 
\begin_inset Formula $10^{-3}$
\end_inset

, and overall accuracy was only slightly affected for solver tolerances
 
\begin_inset Formula $10^{-3}-10^{-2}$
\end_inset

, but then degraded rapidly for looser tolerances.
 Note however, that using the same solver tolerance for all iterative methods
 is perhaps not necessary to maintain temporal accuracy, and looser tolerances
 may be used for the RFD-related linear solves.
 We take the random finite difference parameter 
\begin_inset Formula $\delta=10^{-6}$
\end_inset

 for both schemes as double precision was used for these calculations.
 Results were obtained by averaging 20 independent realizations containing
 
\begin_inset Formula $10^{5}$
\end_inset

 samples, initialized from unique configurations sampled from the equilibrium
 distribution using the MCMC algorithm.
 In addition to the proposed EM-T and T-S schemes, we also compare with
 Fixman's scheme given in Section III.B of 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs"

\end_inset

, implemented using dense linear algebra.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/cp_dist_sig2_2.pdf
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:CP"

\end_inset

Numerical errors in the equilibrium distribution for a boomerang dimer.
 (Upper left panel) Comparison between the correct (marginal of the) Gibbs-Boltz
mann distribution of the cross-point distance, computed using an MCMC method,
 and numerical results from the T-S and EM-T schemes for normalized time
 step size 
\begin_inset Formula $\D{\tau}=0.072$
\end_inset

.
 (Upper right panel) Cumulative error in the distribution of the cross-point
 distance, as measured by the 
\begin_inset Formula $L_{2}$
\end_inset

 norm of the error in the histogram 
\begin_inset Formula $P(d)$
\end_inset

, for the EM-T, T-S and Fixman schemes.
 (Lower panels) Error in the distribution of the cross-point distance for
 the EM-T (left panel), T-S (middle panel), and the Fixman scheme (right
 panel) for several different time step sizes (see legend).
 Note that the scale of the plots changes and that the Fixman scheme is
 unstable for 
\begin_inset Formula $\D{\tau}>0.29$
\end_inset

.
 Error bars indicate 
\begin_inset Formula $95\%$
\end_inset

 confidence intervals and are estimated from multiple independent runs.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:CP"

\end_inset

 shows that even for the smallest time step size considered, the T-S scheme
 is substantially more accurate than the EM-T scheme.
 Note that no data is included for Fixman's scheme for the largest time
 step size considered, because the scheme was seen to be numerically unstable.
 While all of the schemes are seen to be 
\begin_inset Formula $\mathcal{O}(\Delta t)$
\end_inset

 in the cummulative 
\begin_inset Formula $L_{2}$
\end_inset

 error, the order constant for the T-S and Fixman schemes are clearly much
 lower than the EM scheme.
 In terms of accuracy alone, the T-S scheme compares very favorably with
 Fixman's scheme, while also enabling scalable computations for suspensions
 of many rigid bodies.
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sec:MSD"

\end_inset

Dynamic Accuracy
\end_layout

\begin_layout Standard
We now turn our attention to time-dependent statistics by examining the
 equilibrium translational mean squared displacement (MSD) of the cross
 point of one of the two connected boomerangs,
\begin_inset Formula 
\[
\M D(t)=\avv{\D{\V q}_{p}(t)\left(\D{\V q_{p}}(t)\right)^{T}}=\avv{\left(\V q_{p}(t)-\V q_{p}(0)\right)\left(\V q_{p}(t)-\V q_{p}(0)\right)^{T}},
\]

\end_inset

where the average is an ensemble average over equilibrium trajectories and
 
\begin_inset Formula $p=1$
\end_inset

 or 
\begin_inset Formula $p=2$
\end_inset

.
 Since the trajectories of the two boomerangs are statistically identical,
 we will average results over the two particles to improve statistical accuracy.
 Here and in what follows we will assume that the cross point is chosen
 as the tracking point around which the boomerang rotates.
 We may define 
\emph on
short-time
\emph default
 and 
\emph on
long-time
\emph default
 translational diffusion tensors,
\begin_inset Formula 
\begin{equation}
\M{\chi}_{st}=\frac{1}{2}\,\lim_{t\to0}\frac{\M D(t)}{t},\hspace{1em}\M{\chi}_{lt}=\frac{1}{2}\,\lim_{t\to\infty}\frac{\M D(t)}{t}\label{eq:chi_st}
\end{equation}

\end_inset

respectively.
 The Stokes-Einstein relationship implies
\begin_inset Formula 
\begin{equation}
\M{\chi}_{st}=\left(k_{B}T\right)\av{\N_{pp}^{(tt)}}_{GB},\label{eq:SE_short}
\end{equation}

\end_inset

where we have taken an average over the Gibbs-Boltzmann distribution of
 the 
\begin_inset Formula $3\times3$
\end_inset

 translation-translation diagonal block of the mobility matrix corresponding
 to body 
\begin_inset Formula $p$
\end_inset

.
 However, 
\begin_inset Formula $\M{\chi}_{lt}$
\end_inset

 admits no such simple characterizations and is typically challenging to
 compute accurately, requiring many samples from long simulations, as discussed
 extensively in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
\end_layout

\begin_layout Standard
Since we are investigating diffusion near an infinite wall (placed at 
\begin_inset Formula $z=0$
\end_inset

 with normal in the positive 
\begin_inset Formula $z$
\end_inset

 direction), under the influence of gravity, we may define the parallel
 (
\begin_inset Formula $D_{p}^{\Vert}$
\end_inset

) and perpendicular (
\begin_inset Formula $D_{p}^{\bot}$
\end_inset

) MSD of body 
\begin_inset Formula $p$
\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
D_{p}^{\Vert}(t)= & \M D_{xx}(t)+\M D_{yy}(t),\qquad D_{p}^{\bot}(t)=\M D_{zz}(t).\label{eq:parPerp}
\end{align}

\end_inset

At long times the perpendicular MSD 
\begin_inset Formula $D_{p}^{\bot}(t)$
\end_inset

 asymptotically tends towards a finite value, related to the gravitational
 height of the body 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 We focus here on the parallel MSD 
\begin_inset Formula $D_{p}^{\Vert}(t)$
\end_inset

 as this is typically what is measured in experiments 
\begin_inset CommandInset citation
LatexCommand cite
key "BoomerangDiffusion,AsymmetricBoomerangs"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout

\series bold
(Kept for posterity) 
\series default
To derive our method we introduce first a standard result from linear response
 theory.
 Consider a system in thermal equilibrium with Hamiltonian 
\begin_inset Formula $\sM H_{0}$
\end_inset

 and a slightly perturbed system with Hamiltonian 
\begin_inset Formula $\sM H(t)=\sM H_{0}-f(t)B$
\end_inset

 where 
\begin_inset Formula $B$
\end_inset

 is a dynamic variable and 
\begin_inset Formula $f(t)$
\end_inset

 a time dependent function.
 Linear response theory shows that one can measure the average of a magnitude
 
\begin_inset Formula $A(t)$
\end_inset

 over the perturbed system via 
\begin_inset CommandInset citation
LatexCommand cite
key "Frenkel_Smit_book"

\end_inset


\begin_inset Formula 
\begin{equation}
\left\langle A(t)\right\rangle _{\sM H}=\left\langle A(t)\right\rangle _{0}-\frac{1}{k_{B}T}\int_{-\infty}^{t}\left\langle B(0)\dot{A}(t-t')\right\rangle _{0}f(t')\mathrm{d}t',\label{eq:linear-response}
\end{equation}

\end_inset

where the averages on the right hand side are taken over the system at thermal
 equilibrium.
 We can apply this formula to measure the MSD using a non-equilibrium method.
 We pull a boomerang with a constant force 
\begin_inset Formula $F_{i}$
\end_inset

 along the i-axis from time 
\begin_inset Formula $t=0$
\end_inset

 so the Hamiltonian of the system is 
\begin_inset Formula $\sM H(t)=\sM H_{0}-q_{i}F_{i}$
\end_inset

 for 
\begin_inset Formula $t\ge0$
\end_inset

.
 Using equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:linear-response"

\end_inset

 with 
\begin_inset Formula $B=q_{i}$
\end_inset

, 
\begin_inset Formula $A(t)=(q_{i}(t)-q_{i}(0))$
\end_inset

 and 
\begin_inset Formula $f(t)=F_{i}$
\end_inset

 for 
\begin_inset Formula $t\ge0$
\end_inset

, we can derive the following relation
\begin_inset Formula 
\begin{equation}
\left\langle q_{i}(t)-q_{i}(0)\right\rangle _{\sM H}=-\frac{F_{i}}{k_{B}T}\int_{0}^{t}\left\langle q_{i}(0)\dot{q}_{i}(t-t')\right\rangle _{0}\mathrm{d}t'=\frac{F_{i}}{2k_{B}T}\left\langle (q_{i}(t)-q_{i}(0))^{2}\right\rangle _{0},\label{eq:non-eq-MSD}
\end{equation}

\end_inset

where we have integrated 
\begin_inset Formula $\dot{q}(t-t')$
\end_inset

 over time and used that the dynamics at thermal equilibrium is time reversible
 (e.g.
 
\begin_inset Formula $\left\langle q_{i}(0)(q_{i}(t)-q_{i}(0))\right\rangle =\left\langle q_{i}(t)(q_{i}(0)-q_{i}(t))\right\rangle $
\end_inset

).
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
At short times, we can use the Stokes-Einstein formula 
\begin_inset Formula $D_{p}^{\Vert}(t)=2\left(k_{B}T\right)\av{\N_{11}^{(xx)}}_{GB}\,t$
\end_inset

 to validate our simulations.
 To estimate the long-time MSD, we use a non-equilibrium method based on
 linear response theory 
\begin_inset CommandInset citation
LatexCommand cite
key "Frenkel_Smit_book"

\end_inset

.
 Specifically, if we pull one of the boomerangs with a force 
\begin_inset Formula $\V F=F\,\hat{\V x}$
\end_inset

 applied to the cross (tracking) point, 
\begin_inset Formula 
\begin{equation}
\left\langle x_{p}(t)-x_{p}(0)\right\rangle _{\V F}=-\frac{F}{k_{B}T}\int_{0}^{t}\left\langle x_{p}(0)\dot{x}_{p}(t-t')\right\rangle _{0}\mathrm{d}t'=\frac{F}{2k_{B}T}\left\langle (x_{p}(t)-x_{p}(0))^{2}\right\rangle _{0}.\label{eq:noneq-MSD}
\end{equation}

\end_inset

Here the average on the left hand side is an average over nonequilibrum
 trajectories initialized from the GB distribution, while the average on
 the right hand side is an average over equilibrium trajectories.
 The formula 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:noneq-MSD"

\end_inset

 relates the MSD at equilibrium with the mean displacement under a external
 force.
 The nonequilibrium method offers better statistical accuracy at long times
 over computing the MSD if the applied force 
\begin_inset Formula $F$
\end_inset

 is sufficiently large 
\change_deleted -1422339205 1510614113
(but it must
\change_inserted -1422339205 1510614114
but
\change_unchanged
 still 
\change_deleted -1422339205 1510614118
be 
\change_unchanged
small enough to remain in the linear-response regime
\change_deleted -1422339205 1510614120
)
\change_inserted -1422339205 1510614150
 (for the simulations reported below the Péclet number is 
\begin_inset Formula $\text{Pe}=L\,F/\left(k_{B}T\right)\approx0.5$
\end_inset

, where 
\begin_inset Formula $L=2.1\mu\text{m}$
\end_inset

 is the boomerang arm length)
\change_unchanged
.
 To see this, consider a one dimensional diffusion process with constant
 mobility 
\begin_inset Formula $\mu$
\end_inset

,
\begin_inset Formula 
\[
\frac{\mathrm{d}x(t)}{\mathrm{d}t}=\mu F+\sqrt{2k_{B}T\mu}\;\mathcal{W}(t),
\]

\end_inset

whose solution has mean 
\begin_inset Formula $\av{x(t)}=\mu Ft$
\end_inset

 and standard deviation 
\begin_inset Formula $\sqrt{2k_{B}T\mu t}$
\end_inset

.
 The relative statistical uncertainty in the mean displacement 
\begin_inset Formula $\av{x(t)}$
\end_inset

 is 
\begin_inset Formula $\sqrt{2k_{B}T/(\mu F^{2}t)}$
\end_inset

, and therefore decays as time grows.
 By contrast, in the absence of the force the mean MSD is 
\begin_inset Formula $2k_{B}T\mu t$
\end_inset

 while the standard deviation of the MSD is 
\begin_inset Formula $\sqrt{3}\left(2k_{B}T\mu t\right)$
\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
The fourth moment of a centered Gaussian is 
\begin_inset Formula $3\sigma^{4}$
\end_inset


\end_layout

\end_inset

, and therefore the relative statistical uncertainty in the MSD is independent
 of time.
 This assumes we have an infinitely-long trajectory.
 In practice, however, the finite length of the trajectories makes the MSD
 most statistically accurate at short times, and it is beneficial to use
 the nonequilibrium method to estimate the long-time diffusion coefficient.
\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:TwoBoomsMSD"

\end_inset

 shows the results for the MSD of the cross point of one of the boomerangs
 obtained using the EM-T and T-S schemes.
 We can see that both schemes produce the correct slope of the MSD at short
 times (short-time diffusion coefficient), as compared with the Stokes-Einstein
 estimate obtained by computing 
\begin_inset Formula $\av{\N_{11}^{(xx)}}_{GB}$
\end_inset

 accurately using a Monte-Carlo method (solid black line).
 At long times, to within statistical uncertainty, both schemes produce
 the same slope of the MSD (long-time diffusion coefficient) as the non-equilibr
ium method (dashed black line).
 Because the short time MSD is computed as an equilibrium average over the
 Gibbs-Boltzmann distribution (see 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:SE_short"

\end_inset

), the temporal accuracy with which a given scheme samples the equilibrium
 GB distribution (as measured in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:TwoBooms"

\end_inset

) directly effects the accuracy of the short time MSD.
 In particular, the stochastic displacement produced by the EM-T scheme
 has covariance proportional to 
\begin_inset Formula $\D t\N(\V Q)$
\end_inset

.
 Hence, the short time diffusion coefficient produced by the EM-T scheme
 is independent of 
\begin_inset Formula $\D t$
\end_inset

, and the only source of error stems from the error in the equilibrium distribut
ion.
 The inset of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:TwoBoomsMSD"

\end_inset

 shows the short time MSD produced by the EM-T scheme for different time
 steps.
 Here we see clear improvement as the time step is reduced, analogous to
 the results shown in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:CP"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
 
\begin_inset Graphics
	filename figures/TwoBoomsMSD.eps
	width 75text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:TwoBoomsMSD"

\end_inset

Mean square planar displacement of the cross point of one of the boomerangs
 as obtained from trajectories sampled using the EM-T and T-S schemes.
 Error bars indicate 
\begin_inset Formula $95\%$
\end_inset

 confidence intervals.
 Black lines show the reference slope of the MSD at short times (solid),
 as computed using the Stokes-Einstein formula, and long times (dashed),
 as computed using a non-equilibrium method.
 (Inset) Short time parallel MSD computed by the EM-T method for different
 time step sizes.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec:ManyBooms"

\end_inset

Accuracy and Efficiency for Many-Body Suspensions
\end_layout

\begin_layout Standard
To compare the accuracy-efficiency tradeoff for the T-S scheme versus the
 EM-T scheme, we investigate a dense suspension of freely-diffusing colloidal
 boomerangs.
 All of the physical parameters and interaction potentials of the simulation
 are taken to be the same as for the boomerang dimer studied in Section
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "subsec:WeakAccuracy"

\end_inset

, except that we take the solver tolerance for all iterative solvers to
 be 
\begin_inset Formula $10^{-3}$
\end_inset

 as this was found to give statistically indistinguishable results from
 tolerance 
\begin_inset Formula $10^{-4}$
\end_inset

.
 Further, to reduce the computation time, we perform the arithmetic on the
 GPU (multiplication by 
\begin_inset Formula $\Mob$
\end_inset

) in single precision and thus take random the finite difference parameter
 
\begin_inset Formula $\delta=10^{-3}$
\end_inset

 for both schemes.
 For suspensions we employ pseudo periodic boundary conditions 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
 Specifically, for each blob 
\begin_inset Formula $i$
\end_inset

, we sum the hydrodynamic interactions with every other blob 
\begin_inset Formula $j$
\end_inset

 (using the minimum image convention) and also the 8 nearest periodic images
 of blob 
\begin_inset Formula $j$
\end_inset

.
 This is fairly effective in capturing the hydrodynamics of an infinitely
 periodic suspension, without requiring involved Ewald summation techniques
 
\begin_inset CommandInset citation
LatexCommand cite
key "RegularizedStokeslets_WallPeriodic"

\end_inset

, since the presence of the wall screens the hydrodynamic interactions to
 decay as inverse 
\emph on
cubed
\emph default
 distance.
 In order to challenge the temporal integrators we consider a dense suspension
 in which steric exclusion plays a large role in the dynamics.
\end_layout

\begin_layout Standard
Specifically, we will simulate 256 boomerangs in a domain which is semi-infinite
 in 
\begin_inset Formula $z$
\end_inset

 and periodic with unit cell of length 
\begin_inset Formula $45.3\mu$
\end_inset

m in both the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 directions, as illustrated in the bottom panel of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Booms"

\end_inset

.
 We have examined a number of relevant statistics (marginals of the equilibrium
 distribution) and found the radial distribution function 
\begin_inset Formula $g(r)$
\end_inset

 to be the most sensitive measure.
 We compute 
\begin_inset Formula $g(r)$
\end_inset

 using the minimum Euclidean distance between two boomerangs, approximated
 as the smallest distance between a pair of blobs taken from distinct bodies.
 We normalize 
\begin_inset Formula $g(r)$
\end_inset

 as if the suspension were two dimensional, as was done in 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

, in order to ensure that 
\begin_inset Formula $g(r)\rightarrow1$
\end_inset

 for large 
\begin_inset Formula $r$
\end_inset

.
 For each scheme and value of 
\begin_inset Formula $\D{\tau}$
\end_inset

, we simulate 8 independent trajectories with 
\begin_inset Formula $10^{4}$
\end_inset

 samples in each, initialized using unique configurations sampled from the
 equilibrium distribution using an MCMC algorithm.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/gr_error.pdf
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:gr"

\end_inset

Accuracy of the radial distribution function 
\begin_inset Formula $g(r)$
\end_inset

 for a dense suspension of boomerangs (illustrated in the bottom panel of
 Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Booms"

\end_inset

), for several values of the normalized time step size 
\begin_inset Formula $\D{\tau}$
\end_inset

.
 (Upper left panel) Comparison with the correct 
\begin_inset Formula $g(r)$
\end_inset

 computed using an MCMC method, for 
\begin_inset Formula $\D{\tau}=0.144$
\end_inset

 for the EM-T and T-S schemes.
 The semi-log scale inset zooms in on nearly touching boomerangs to reveal
 a much larger amount of particle (near) overlaps for the EM-T scheme.
 (Upper right panel) Cumulative error as a function of cost per unit time
 (see main text).
 (Lower panels) Error in the radial distribution function 
\begin_inset Formula $g(r)$
\end_inset

 for the EM-T (left panel) and T-S (right panel) schemes for several different
 time step sizes (see legend).
 Error bars indicate 
\begin_inset Formula $95\%$
\end_inset

 confidence intervals.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The bottom two panels of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:gr"

\end_inset

 show that the T-S scheme is notably more accurate than the EM-T scheme
 for the same value of the time step 
\begin_inset Formula $\D{\tau}$
\end_inset

.
 It is also worthy of note that we were able to run the T-S scheme with
 fair accuracy using 
\begin_inset Formula $\D{\tau}=0.29$
\end_inset

, which was seen to be unstable for the EM-T scheme.
 However, while the T-S scheme is more accurate, it also requires one more
 mobility solve per time step than the EM-T scheme.
 Therefore, to really determine which scheme is best for large-scale simulation,
 we must define a notion of accuracy and cost and determine which scheme
 achieves a given level of accuracy for a smaller computational cost.
\end_layout

\begin_layout Standard
We define a cumulative measure of accuracy using a modified 
\begin_inset Formula $L_{2}$
\end_inset

 error of the 
\begin_inset Formula $g(r)$
\end_inset

 histograms relative to reference values computed with high statistical
 accuracy using an MCMC algorithm.
 We account for statistical errors by considering a weighted 
\begin_inset Formula $L_{2}$
\end_inset

 norm proportional to the log-likelihood, 
\begin_inset Formula 
\begin{equation}
\text{Error}\coloneqq\sqrt{{\displaystyle \frac{1}{2}\int_{0}^{R}\left(\frac{g^{\D t}(r)-g_{\text{MCMC}}(r)}{\sigma(r)}\right)^{2}dr}},\label{L2W}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma(r)$
\end_inset

 is the standard deviation estimated empirically using multiple independently-se
eded simulations.
 We take 
\begin_inset Formula $R=2.5a$
\end_inset

 since for 
\begin_inset Formula $r\gtrsim2.5a$
\end_inset

 the error in 
\begin_inset Formula $g(r)$
\end_inset

 is dominated by sampling (statistical) error for both schemes.
 
\end_layout

\begin_layout Standard
Since in our specific case the computational cost is dominated by (dense)
 multiplications of the blob-blob mobility matrix with a vector, we define
 the cost per unit time as the (average) total number of multiplications
 by 
\begin_inset Formula $\Mob$
\end_inset

 per time step, divided by 
\begin_inset Formula $\D{\tau}$
\end_inset

.
 We observe that when a solver tolerance of 
\begin_inset Formula $10^{-3}$
\end_inset

 is used, the preconditioned iterative methods to solve the saddle point
 system, and to compute 
\begin_inset Formula $\Mob^{1/2}$
\end_inset

, will both converge in 5 iterations most of the time.
 Thus, the total number of multiplications per time step for the T-S scheme
 is 22 (
\begin_inset Formula $3\times5+5+2$
\end_inset

 for three mobility solves, one Lanczos iteration, and one RFD on 
\begin_inset Formula $\Mob$
\end_inset

), while the EM-T scheme requires 17 (
\begin_inset Formula $2\times5+5+2$
\end_inset

).
 
\end_layout

\begin_layout Standard
The upper right panel of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:gr"

\end_inset

 shows that the T-S scheme costs less per unit time than the EM-T scheme
 for any desired accuracy.
 We will therefore use the T-S schemes in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BrownRoll"

\end_inset

, and recommend it for suspensions confined above a no-slip wall.
 Nevertheless, the cost of each scheme depends heavily on how expensive
 it is to compute the action of 
\begin_inset Formula $\Mob$
\end_inset

 and 
\begin_inset Formula $\Mob^{\frac{1}{2}}$
\end_inset

, and we recommend repeating the cost-accuracy balance computations reported
 here for each specific application/code.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec:BrownRoll"

\end_inset

Uniform suspensions of Brownian Rollers
\end_layout

\begin_layout Standard
Active suspensions of rotating spherical colloids (microrollers) sedimented
 above a bottom wall have been recently investigated using both experiments
 and simulations 
\begin_inset CommandInset citation
LatexCommand cite
key "Rollers_NaturePhys"

\end_inset

.
 The colloids have an embedded hematite which makes them weakly ferromagnetic
 and thus easily rotated by an external magnetic field, as illustrated in
 Fig.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:RollersSnapshot"

\end_inset

.
 Because of the presence of a nonzero rotation-translation coupling due
 to the bottom wall, micro-rollers translate parallel to the wall.
 Collective flow effects dominate the dynamics of many-body suspensions,
 and the particles translate much faster at larger densities.
 For non-uniform suspensions, shocks were observed to form and destabilize
 into fingering instabilities, and deterministic simulations were performed
 to interrogate the observations.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

, the effects of Brownian motion were included in the simulations to demonstrate
 the quantitative effect that fluctuations have on the the development and
 progression of the fingering instability.
 In particular, it is important to note that Brownian motion sets the equilibriu
m gravitational height of the colloids, and therefore must be included to
 obtain quantitative predictions that can directly be compared to experiments.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "NonlocalShocks_Rollers"

\end_inset

, the nonlocal nature of the shock front was further elucidated, and propagation
 of density waves in a uniform suspension translating parallel to the wall
 was investigated using both experiments and simulation.
 One of the key parameters that enters in the simplified equations describing
 the dynamics of density fluctuations (see Eq.
 (4) in 
\begin_inset CommandInset citation
LatexCommand cite
key "NonlocalShocks_Rollers"

\end_inset

) around a uniform state is the mean suspension velocity 
\begin_inset Formula $\bar{V}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/Rollors-3blob-hem-1080-lowres.png
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RollersSnapshot"

\end_inset

A snapshot of a steadily-translating uniform suspension of 256 microrollers,
 each made up of 42 blobs (colored by their height above the floor), at
 planar packing density 
\begin_inset Formula $\phi=0.4$
\end_inset

.
 Each particle has an embedded magnet, illustrated as a cluster of fuchsia
 blobs.
 Note that although for constant applied torque the particle orientation
 does not enter in the equations of motion for translation, our algorithm
 keeps track of the orientation of each colloid, which can be used to more
 accurately compute a time-dependent magnetic torque on the particles if
 desired.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
At higher densities, the mean velocity 
\begin_inset Formula $\bar{V}$
\end_inset

 is dominated by collective effects and near-field hydrodynamic interactions
 between the particles and between the particles and the wall.
 In all prior work 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers,NonlocalShocks_Rollers"

\end_inset

, rollers were represented using only one blob, and the Rotne-Prager-Blake
 tensor was used to add the active translation as a deterministic forcing
 term.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

, it was demonstrated that using more blobs to discretize spherical particles
 gives much greater accuracy for hydrodynamics.
 We are here able to, for the first time, consistently and sufficiently
 accurately resolve hydrodynamics 
\emph on
and
\emph default
 account for thermal fluctuations, and thus obtain 
\emph on
quantitative
\emph default
 predictions that can be compared to experiments.
 Following 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

, we take 
\begin_inset Formula $\eta=1$
\end_inset

 mPa
\begin_inset Formula $\cdot$
\end_inset

s, the hydrodynamic radius of the particles 
\begin_inset Formula $R_{h}=0.656\ \mu$
\end_inset

m, excess (buoyant) mass 
\begin_inset Formula $m_{e}g=1.24\times10^{-14}\frac{\text{kg m}}{\text{s}^{2}}$
\end_inset

, and apply a constant, identical torque on every particle, 
\begin_inset Formula $\V T=8\pi\eta\omega R_{h}^{3}\widehat{\V y}$
\end_inset

, where we take the angular frequency 
\begin_inset Formula $\omega=10$
\end_inset

Hz.
 We use the T-S scheme with 
\begin_inset Formula $\D t=0.008$
\end_inset

s.
 The particle-particle and particle-wall interaction potentials are as described
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers"

\end_inset

.
 We discretize the rollers using 1, 12, or 42 blobs (illustrated in Fig.
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:RollersSnapshot"

\end_inset

), following 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

.
 It is important to note that for 
\begin_inset Formula $12$
\end_inset

 or 
\begin_inset Formula $42$
\end_inset

 blobs per particle the translation-rotation coupling inducing the active
 motion is captured by the multiblob model itself rather than added by hand
 as it is for a single blob.
 After an initial, transient period, we computed individual particle velocities
 over intervals of 
\begin_inset Formula $1/24$
\end_inset

s, and collected histograms of particles' velocities at the steady translating
 state 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Note that the analysis in 
\begin_inset CommandInset citation
LatexCommand cite
key "NonlocalShocks_Rollers"

\end_inset

 shows that the steady uniform translating state is stable, and that density
 fluctuations propagate as waves without growing or shrinking in time.
\end_layout

\end_inset

.
 Different time intervals to compute the velocity were also explored but
 no substantial change was observed.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/Rollers_H_V.eps
	lyxscale 90
	width 105text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rollers"

\end_inset

Histograms of the microrollers' heights above the wall (
\begin_inset Formula $P(h)$
\end_inset

, top panels) and their velocities (
\begin_inset Formula $P(V)$
\end_inset

, bottom panels), for two packing densities in the plane, 
\begin_inset Formula $\phi=0.2$
\end_inset

 (left panels) and 
\begin_inset Formula $\phi=0.4$
\end_inset

 (right panels), for a (pseudo)periodic active suspension at steady state.
 Solid vertical lines demarcate the mean of the velocity distributions.
 Curves marked 
\begin_inset Quotes eld
\end_inset

equilibrium
\begin_inset Quotes erd
\end_inset

 use particle positions sampled from the equilibrium GB distribution (in
 the absence of activity) using an MCMC method.
 All other curves are results of dynamic BD simulations using the T-S scheme
 and either 1, 12 or 42 blobs to resolve each spherical colloid.
 (Top panels) Comparison of the height distribution 
\begin_inset Formula $P(h)$
\end_inset

 for 
\begin_inset Formula $\phi=0.2$
\end_inset

 (right) and 
\begin_inset Formula $\phi=0.4$
\end_inset

 (left), as set by a balance of thermal noise, active vertical flows and
 gravity.
 (Bottom panels) Comparison of the velocity distribution 
\begin_inset Formula $P(V)$
\end_inset

 for 
\begin_inset Formula $\phi=0.2$
\end_inset

 (right) and 
\begin_inset Formula $\phi=0.4$
\end_inset

 (left).
 For the curves marked as equilibrium, velocities were generated by solving
 a deterministic mobility problem with particles discretized by 42 blobs,
 using configurations sampled by an MCMC method.
 Insets show 
\begin_inset Formula $P(V)$
\end_inset

 for the finest resolution split into two groups based on particle height
 (
\begin_inset Formula $h\lessgtr2R_{h}$
\end_inset

), where the normalization factor for the distributions is based on the
 fraction of the total number of particles in the given subgroup.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/deterministic_compare.png
	lyxscale 90
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:rollers-det"

\end_inset

Histograms of the microrollers' heights above the wall (
\begin_inset Formula $P(h)$
\end_inset

, top panels) and their velocities (
\begin_inset Formula $P(V)$
\end_inset

, bottom panels), for Brownian (left panels) and deterministic (right panels),
 for a (pseudo)periodic active suspension at steady state.
 Solid vertical lines demarcate the mean of the velocity distributions.
 Either 12 or 42 blobs are used to resolve each spherical colloid to obtain
 (left panels) results of dynamic BD simulations using the T-S scheme (right
 panels) results of dynamic deterministic simulations using an AB scheme.
 (Top panels) Comparison of the height distribution 
\begin_inset Formula $P(h)$
\end_inset

, as set by a balance of thermal noise (in the Brownian case), active vertical
 flows and gravity.
 (Bottom panels) Comparison of the velocity distribution 
\begin_inset Formula $P(V)$
\end_inset

.
 Insets show 
\begin_inset Formula $P(V)$
\end_inset

 for the finest resolution split into two groups based on particle height
 (
\begin_inset Formula $h\lessgtr2R_{h}$
\end_inset

), where the normalization factor for the distributions is based on the
 fraction of the total number of particles in the given subgroup.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rollers"

\end_inset

 shows histograms of the particles' heights above the wall (
\begin_inset Formula $P(h)$
\end_inset

, top panel) and their velocities (
\begin_inset Formula $P(V)$
\end_inset

, bottom panels), for two packing densities in the plane, 
\begin_inset Formula $\phi=n\left(\pi R_{h}^{2}\right)=0.2$
\end_inset

 (left panels) and 
\begin_inset Formula $\phi=0.4$
\end_inset

 (right panels), where 
\begin_inset Formula $n$
\end_inset

 is the number density in the plane.
 We use 256 particles for each case; no significant change in the results
 was observed when 1024 particles were used, confirming that finite size
 effects are small.
 The equilibrium Gibbs-Boltzmann height distributions were computed by using
 an MCMC method, and are not affected by the resolution of the multiblobs,
 which only changes the (hydro)dynamics of the suspension.
 To understand the effects on 
\begin_inset Formula $P(V)$
\end_inset

 due to changes in 
\begin_inset Formula $P(h)$
\end_inset

 caused by the active motion, we estimate the distribution of particles
 velocities at a fictitious 
\begin_inset Quotes eld
\end_inset

equilibrium
\begin_inset Quotes erd
\end_inset

 state by sampling particle positions from the equilibrium GB distribution
 using MCMC.
 We then apply a constant torque 
\begin_inset Formula $\V T$
\end_inset

 on each particle and solve a 
\emph on
deterministic
\emph default
 mobility problem (using the 42-blob model of the particles) for the particles'
 velocities.
 The bottom panels in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rollers"

\end_inset

 show a large mismatch between these static predictions and the actual dynamics
 of the particles.
 This underscores the importance of explicitly simulating the Brownian dynamics
 in this system in order to sample the out-of-equilibrium steady state distribut
ion, which is quite different from the GB distribution due to the strong
 active flows.
\end_layout

\begin_layout Standard
The bottom panels in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rollers"

\end_inset

 demonstrate that the more resolved results for 
\begin_inset Formula $P(V)$
\end_inset

 obtained using 12 and 42 blobs closely match for both packing densities,
 while the minimally-resolved distributions using just one blob per particle
 are fairly dissimilar from the others.
 This same mismatch in distribution based on particle resolution is also
 seen in the height distributions for both packing densities, though it
 is less pronounced.
 While this certainly indicates that minimally-resolved simulations are
 not sufficient make quantitative predictions, all of the particle resolutions
 considered produce qualitatively similar results.
 More specifically, we estimate the mean velocity among all particles in
 
\begin_inset Formula $\mu\mbox{m}/s$
\end_inset

 for 
\begin_inset Formula $\phi=0.2$
\end_inset

 to be 
\begin_inset Formula $\bar{V}=15.3$
\end_inset

 for 1 blob, 
\begin_inset Formula $\bar{V}=12.2$
\end_inset

 for 12 blobs, 
\begin_inset Formula $\bar{V}=11.4$
\end_inset

 for 42 blobs per sphere, compared to 
\begin_inset Formula $\bar{V}=10.9$
\end_inset

 predicted by 
\begin_inset Quotes eld
\end_inset

equilibrium
\begin_inset Quotes erd
\end_inset

 static sampling (with 42 blobs).
 For 
\begin_inset Formula $\phi=0.4$
\end_inset

, we estimate 
\begin_inset Formula $\bar{V}=28.4$
\end_inset

 for 1 blob, 
\begin_inset Formula $\bar{V}=21.3$
\end_inset

 for 12 blobs, 
\begin_inset Formula $\bar{V}=19.8$
\end_inset

 for 42 blobs per sphere, compared to 
\begin_inset Formula $\bar{V}=17.9$
\end_inset

 predicted by 
\begin_inset Quotes eld
\end_inset

equilibrium
\begin_inset Quotes erd
\end_inset

 static sampling.
 These results also indicate that using as few as 12 blobs per sphere can
 give sufficiently accurate predictions (with relative error less than 
\begin_inset Formula $10\%$
\end_inset

) to be quantitatively compared to experimental measurements.

\change_inserted -1422339205 1510950346
 Note that the mean velocity obtained from the most-resolved computations
 leads to an estimate of the Péclet number 
\begin_inset Formula $\text{Pe}=\left(6\pi\eta\right)R_{h}^{2}\bar{V}/\left(k_{B}T\right)$
\end_inset

 of 
\begin_inset Formula $\text{Pe}\approx22$
\end_inset

 for 
\begin_inset Formula $\phi=0.2$
\end_inset

 and 
\begin_inset Formula $\text{Pe}\approx39$
\end_inset

 for 
\begin_inset Formula $\phi=0.4$
\end_inset

.
 This indicates that the horizontal motion is dominated by the active flow.
 However, the Brownian motion is important for setting the height of the
 particles above the bottom wall, as can be seen from the fact that the
 distribution of heights 
\begin_inset Formula $P\left(h\right)$
\end_inset

 is not changed significantly by the active motion.
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $\phi=0.4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
Fast Group
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
Slow Group
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
Whole Group
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
MCMC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=35.1033$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
1 blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=74.1044$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=25.7806$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=55.5226$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
12 blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=57.7581$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=19.5773$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=42.0011$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
42 blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=54.4849$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=18.0044$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=38.6932$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $\phi=0.2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
Fast Group
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
Slow Group
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
Whole Group
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
MCMC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=21.2832$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
1 blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=40.7202$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=19.3728$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=30.0035$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
12 blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=33.9924$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=14.9914$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=23.7988$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
42 blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=32.9304$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=13.6278$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -1422339205 1510949532
\begin_inset Formula $Pe=22.3696$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset

Where 
\begin_inset Formula $D=\frac{k_{B}T}{6\pi\eta R_{h}}=0.33497$
\end_inset

 and 
\begin_inset Formula $Pe_{\text{fast/slow}}=\frac{R_{h}\bar{V}_{\text{fast/slow}}}{D}$
\end_inset

.
\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Standard
All of the simulation results in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rollers"

\end_inset

 show bimodal distributions for both the particles' heights and velocities.
 Particularly prominent in the particle velocity distribution for 
\begin_inset Formula $\phi=0.4$
\end_inset

, but present for 
\begin_inset Formula $\phi=0.2$
\end_inset

 as well, are two peaks indicating the existence of two distinct populations
 of 
\begin_inset Quotes eld
\end_inset

fast
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

slow
\begin_inset Quotes erd
\end_inset

 particles.
 Close examination of the height distributions reveals a similar bimodality,
 and our simulations indicate a strong correlation between particle height
 and velocity.
 We separate particles into two subgroups roughly corresponding to the two
 peaks in 
\begin_inset Formula $P(h)$
\end_inset

, and identify the fast particles as the group corresponding to 
\begin_inset Formula $h>2R_{h}$
\end_inset

, while the remaining particles are slower, as seen in the inset figures
 in the lower panels of Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:rollers"

\end_inset

.
 This separation is surprising as we might expect the opposite given that
 a single particle will translate faster if it is placed closer to the wall.
 This indicates the importance of collective flows and packing effects in
 these suspensions.
 Physically, the higher packing density causes a relatively dense monolayer
 of particles to form around the gravitational height, 
\begin_inset Formula $h_{G}=R_{h}+k_{B}T/m_{e}g\approx1\mu\mbox{m}$
\end_inset

.
 The rest of the particles form a sparser and more diffuse (in the vertical
 direction) monolayer above the first at height of roughly 
\begin_inset Formula $2h_{G}$
\end_inset

, and are rapidly advected by the collective flow as they 
\begin_inset Quotes eld
\end_inset

slide
\begin_inset Quotes erd
\end_inset

 on top of the bottom layer.
\end_layout

\begin_layout Standard
The presence of two populations of particles at different heights and moving
 at different velocities makes experimental measurements of 
\begin_inset Formula $P(V)$
\end_inset

 or even 
\begin_inset Formula $\bar{V}$
\end_inset

 more difficult.
 Namely, at these packing densities it is not possible to track individual
 particles to measure individual particle velocities, and indirect method
 such as particle image velocimetry (PIV) are used to estimate 
\begin_inset Formula $\bar{V}$
\end_inset

, which can lead to bias in the presence of fast and slow particles.
 Direct comparison of our computational estimates to experimental measurements
 is therefore deferred for future work.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
As mentioned at the beginning of the section, the mean suspension velocity,
 
\begin_inset Formula $\bar{V}$
\end_inset

, has been identified as a central parameter in describing density fluctuations
 in this system 
\begin_inset CommandInset citation
LatexCommand cite
key "NonlocalShocks_Rollers"

\end_inset

.
 Experiments were performed in 
\begin_inset CommandInset citation
LatexCommand cite
key "Rollers_NaturePhys,NonlocalShocks_Rollers"

\end_inset

 for this system to measure, among other things, 
\begin_inset Formula $\bar{V}$
\end_inset

, which will serve as a quantitative source for comparison with the numerical
 results obtained herein.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "table:the_only_table"

\end_inset

 summarizes these results.
 We see that when all of the particles in a simulation are used to compute
 
\begin_inset Formula $\bar{V}$
\end_inset

, the results deviate considerably from experiment in every case (by as
 much as a factor of 
\begin_inset Formula $\sim3$
\end_inset

 in the one blob cases).
 However, the bimodal nature of 
\begin_inset Formula $P(V)$
\end_inset

 means that the manner in which the experimentally obtained values obtained
 must be considered carefully.
 Specifically, a confocal microscope was used to track individual particles,
 under which particles are only imaged at a certain height range (focal
 plane).
 If the focal plane is not set high enough, the faster grouping of particles
 corresponding to 
\begin_inset Formula $h>2R_{h}$
\end_inset

 could be undersampled resulting in a biased distribution for 
\begin_inset Formula $P(V)$
\end_inset

 and the lower values for 
\begin_inset Formula $\bar{V}$
\end_inset

 as compared with our results from simulation.
 Further, particle image velocimetry (PIV) was used to obtain the experimentally
 measured velocities wherein the positions of tracer particles are tracked
 and used to obtain velocities.
 However, particle tracking between images is not guaranteed for high densities
 such as those studied here.
 Hence, when there is a bimodal distribution in the velocities rather than
 a single, well defined peak, it is not clear whether this feature will
 be captured by PIV.
 We argue that the experimentally obtained values may be subject to the
 aforementioned sources for error by noting that for both 
\begin_inset Formula $\phi=0.4,0.2$
\end_inset

, average velocities obtained by considering only the unimodal group 
\begin_inset Formula $h<2R_{h}$
\end_inset

 agree quite well with the experimental values when the 12 and 42 blob particles
 are used.
 
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "table:the_only_table"

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mean velocities 
\begin_inset Formula $\phi=0.2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
all particles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h<2R_{h}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h>2R_{h}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1-blob
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.3203
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9.8921
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.7925
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12-blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.1521
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7.6549
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17.3571
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
42-blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11.4223
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6.9586
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.8148
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Equilibrium
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.8676
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9.2207
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.0719
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experiment (
\begin_inset Formula $\phi=0.24$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.22
\begin_inset Formula $\pm$
\end_inset

0.21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NA
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mean velocities 
\begin_inset Formula $\phi=0.4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
all particles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h<2R_{h}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h>2R_{h}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1-blob
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28.3508
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
13.164
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
37.839
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12-blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21.4361
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9.9604
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
29.44
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
42-blobs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19.7574
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9.1934
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
27.8209
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Equilibrium
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17.9243
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14.5791
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24.7785
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Experiment (
\begin_inset Formula $\phi=0.42$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11.46
\begin_inset Formula $\pm$
\end_inset

0.34
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NA
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\color green
Note that I included the grouping results for the equilibrium even though
 for 
\color inherit

\begin_inset Formula $\phi=0.4$
\end_inset

 
\color green
they didn't group very well.
 I suggest we get rid of these numbers but I reported them in case you wanted
 to keep them and just say that they are bad or something.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Conclusions
\end_layout

\begin_layout Standard
In this work we designed efficient and robust temporal integrators for the
 simulation of many rigid particles suspended in a fluctuating viscous fluid.
 Hydrodynamic interactions were computed using a rigid multiblob model 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

 of the particles, and here we proposed a method to generate the Brownian
 increments of the particles at a computational cost that is no larger than
 that of solving a mobility problem.
 We demonstrated that the block-diagonal preconditioner used to solve mobility
 problems in 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

 is equally effective as a preconditioner for the Lanczos algorithm to compute
 Brownian increments for the blobs.
 The stochastic drift term arising from the configuration-dependent mobility
 matrix were computed using traction-corrected or slip-corrected random
 finite differences.
 We presented a traction-corrected Euler-Maruyama scheme (EM-T) (algorithm
 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

), as well as a slip-corrected Trapezoidal scheme (T-S) (algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

).
 We have made our python implementation (with PyCUDA acceleration) of the
 methods described here available at 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

https://github.com/stochasticHydroTools/RigidMultiblobsWall
\end_layout

\end_inset

.
 Both the EM-T and T-S schemes scale linearly in complexity with the number
 of rigid particles being simulated if the iterative methods used to compute
 deterministic and Brownian blob velocities are based on fast methods.
 We confirmed that both schemes correctly reproduce the equilibrium Gibbs-Boltzm
ann distribution for sufficiently small time step sizes, and found the T-S
 scheme to be notably superior in accuracy for the same computational effort
 for large-scale problems.
 We used the T-S scheme to study the non-equilibrium dynamics of an active
 suspension of microrollers confined above a no-slip bottom wall, and demonstrat
ed that as few as 12 blobs per sphere gives numerical errors on the order
 of 10% or less, unlike previous simulations of existing microroller experiments
 
\begin_inset CommandInset citation
LatexCommand cite
key "MagneticRollers,NonlocalShocks_Rollers"

\end_inset

.
 The use of particle image velocimetry (PIV) in 
\begin_inset CommandInset citation
LatexCommand cite
key "Rollers_NaturePhys"

\end_inset

 to experimentally estimate the average particle velocity can be biased
 from the bimodality of the particle velocities, rendering a direct comparison
 with experimental results currently unobtainable.
 In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BrownRoll"

\end_inset

, we identified two well separated, unimodal, populations of microrollers
 demarcated by their heights.
 This separation can perhaps be used to design new experimental techniques
 to accurately measure the particles' velocities within each population.
\end_layout

\begin_layout Standard
There are number of application-dependent parameters that can be tweaked
 to improve efficiency.
 For instance if small particle displacements are expected over a time step,
 one can wait several time steps before recomputing the (Cholesky) factorization
s of 
\begin_inset Formula $\Mob$
\end_inset

 that enter in the block-diagonal preconditioner.
 Here we used the same relative error tolerance for all iterative methods,
 and found a relatively loose tolerance of 
\begin_inset Formula $10^{-3}$
\end_inset

 to be sufficient.
 However, one could use a different solver tolerances in, for example, steps
 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:TracStep1"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand ref
reference "step:MhalfEM"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:Udef"

\end_inset

 of algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

 for the EM-T scheme.
 Further, while the EM-T and T-S schemes were found to be optimal for the
 applications considered herein, other schemes such as an Adams-Bashforth
 variant of the EM-T scheme, or a midpoint variant of the T-S scheme are
 straightforward extensions and may prove optimal for other applications
 and implementations.
 In fact, our biggest contribution here is the development of the traction-corre
cted and slip-corrected RFDs, which can be used as tools to construct other
 schemes.
 It is important to realize that showing theoretically that a certain scheme
 is consistent in the limit 
\begin_inset Formula $\D t\rightarrow0$
\end_inset

 is 
\emph on
not
\emph default
 sufficient – establishing numerically that the scheme is robust for 
\begin_inset Formula $\D t$
\end_inset

 on the order of the 
\emph on
diffusive
\emph default
 time scale, as we have done here for the EM-T and T-S schemes, is crucial.
 While we do not have a detailed theoretical understanding of the errors
 that arise for finite 
\begin_inset Formula $\D t$
\end_inset

, one important consideration is that RFDs only give the stochastic drift
 term in expectation, and it is important to control and reduce their variance
 and not just their mean.
\end_layout

\begin_layout Standard
The methods presented in this work are fairly general and can be extended
 to other geometries and ways of computing hydrodynamic interactions.
 In periodic domains, we can use the Positively Split Ewald (PSE) method
 
\begin_inset CommandInset citation
LatexCommand cite
key "SpectralRPY"

\end_inset

 to compute deterministic and Brownian blob velocities, and no change is
 made in algorithms 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

 or 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

 to account for this.
 However, in this case, generating Brownian blob displacements becomes rather
 inexpensive compared to a mobility solve, and it is possible that a midpoint
 split scheme would become preferable over the T-S scheme in terms of efficiency
-accuracy balance.
 Note that the PSE method could be extended to other geometries such as
 doubly-periodic domains (e.g., membranes) by building on recently-developed
 Spectral Ewald methods 
\begin_inset CommandInset citation
LatexCommand cite
key "SpectralEwald_DoublyPeriodic,BoundaryIntegral_Wall"

\end_inset

.
 To the best of our knowledge, there is presently no known method to compute
 Brownian blob increments for infinite unbounded domains in (near) linear
 time; we relied here explicitly on the the simplicity of the Rotne-Prager-Blake
 tensor and the screening by the wall to handle particles confined in a
 half-space.
\end_layout

\begin_layout Standard
All of the computations performed in this work used a rather coarsely resolved
 multiblob model to represent the rigid bodies.
 In future work, we will apply the temporal integrators proposed here to
 more accurate representations of the geometry and hydrodynamics using the
 recently-developed Fluctuating Boundary Integral Method (FBIM) 
\begin_inset CommandInset citation
LatexCommand cite
key "FBIM"

\end_inset

.
 Both of the temporal integrators presented here can be used without modificatio
n with FBIM, but a midpoint scheme may be preferable because of the low-cost
 of computing Brownian terms compared to solving mobility problems.
\end_layout

\begin_layout Standard
All of the methods presented herein relied extensively on an explicit representa
tion of 
\begin_inset Formula $\Mob$
\end_inset

, which restricts the choice of domain and boundary conditions that we may
 use to those for which an analytical expressions (and preferably a fast
 method to compute its action) for the RPY mobility is available.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs"

\end_inset

 the Stokes equations are solved explicitly on an Eulerian grid for fully
 confined domains such as slit channels, and Immersed Boundary (IB) interpolatio
n and spreading operators are used to couple the blobs to the fluid solver.
 This Green's-function-free or 
\begin_inset Quotes eld
\end_inset

explicit-solvent
\begin_inset Quotes erd
\end_inset

 (but still inertia-less) approach implicitly computes the action of 
\begin_inset Formula $\Mob$
\end_inset

 in linear time in the number of fluid grid cells.
 Some of us demonstrated in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianBlobs"

\end_inset

 that the action of 
\begin_inset Formula $\Mob^{\frac{1}{2}}$
\end_inset

 can also be computed using the IB approach at minimal additional cost by
 using fluctuating hydrodynamics.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidIBM,RigidMultiblobs"

\end_inset

, the IB approach was extended to rigid bodies (multiblobs), but without
 accounting for Brownian motion.
 The schemes presented herein can, in principle, be used with only minor
 modification with the rigid-body IB method to simulate Brownian motion
 of rigid particles in fully confined domains, when explicit representation
 of 
\begin_inset Formula $\Mob$
\end_inset

 is not available.
 However, the efficiency of the methods used in this work hinged on the
 action of 
\begin_inset Formula $\Mob$
\end_inset

 being computed rapidly, and hence the temporal integrators should be modified
 to account for the comparatively expensive explicit-solvent IB solvers
 introduced in 
\begin_inset CommandInset citation
LatexCommand cite
key "RigidMultiblobs"

\end_inset

.
 Efficient simulation of rigid, Brownian particles in general confined domains
 will be the subject of future work.
\end_layout

\begin_layout Acknowledgments
We are grateful to Blaise Delmotte for his help with simulations of active
 roller suspensions, and to Michelle Driscoll and Paul Chaikin for numerous
 discussions about experiments on microrollers.
 This work was supported in part by the National Science Foundation under
 collaborative award DMS-1418706 and by DMS–1418672, and by the U.S.
 Department of Energy Office of Science, Office of Advanced Scientific Computing
 Research, Applied Mathematics program under award DE-SC0008271.
 We thank the NVIDIA Academic Partnership program for providing GPU hardware
 for performing the simulations reported here.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Appendix
\end_layout

\begin_layout Standard
\start_of_appendix
\begin_inset ERT
status open

\begin_layout Plain Layout

%dummy comment inserted by tex2lyx to ensure that this paragraph is not
 empty
\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "add:EMrfd"

\end_inset

Euler-Maruyama Scheme
\end_layout

\begin_layout Standard
In section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:RFD"

\end_inset

 we noted that a simple means of computing an RFD on 
\begin_inset Formula $\sM B\equiv\N$
\end_inset

, is to use 
\begin_inset Formula $\Delta\V P=\Delta\V Q=\sqrt{k_{B}T}\,\V W$
\end_inset

 in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDB"

\end_inset

, where 
\begin_inset Formula $\V W$
\end_inset

 is a vector drawn from the standard normal distribution.
 However, incrementing the translational and rotational components of the
 configuration 
\begin_inset Formula $\V Q$
\end_inset

 by the same quantity may cause translation and rotation of a body by very
 different magnitudes.
 This, in turn, may result in large variance of the quantity 
\begin_inset Formula $\partial_{\V Q}\N\colon\left[\V W\V W^{T}\right]$
\end_inset

 (see 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDB"

\end_inset

), and hence slow the convergence to 
\begin_inset Formula $\partial_{\V Q}\cdot\N$
\end_inset

 in expectation.
 To remedy this, we simply ensure that a given body is being randomly translated
 and rotated by the same amount.
 
\end_layout

\begin_layout Standard
Specifically, we choose a length scale, 
\begin_inset Formula $L_{p}$
\end_inset

, to represent the size of body 
\begin_inset Formula $p$
\end_inset

, and compute the random displacement,
\begin_inset Formula 
\begin{equation}
\Delta\V Q_{p}=\begin{bmatrix}L_{p}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}
\end{equation}

\end_inset

as well as the random forces and torques,
\begin_inset Formula 
\begin{equation}
\V W_{p}^{FT}=k_{B}T\begin{bmatrix}L_{p}^{-1}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}
\end{equation}

\end_inset

where 
\begin_inset Formula $\V W_{p}^{f},\V W_{p}^{\tau}$
\end_inset

 are both three dimensional standard Gaussian random vectors, and we form
 the composite vectors 
\begin_inset Formula $\V W^{FT}=\left[\V W_{p}^{FT}\right]$
\end_inset

 and 
\begin_inset Formula $\Delta\V Q=\left[\Delta\V Q_{p}\right]$
\end_inset

.
 The drift can then be computed using a simple RFD, 
\begin_inset Formula 
\begin{equation}
\frac{1}{\delta}\av{\left\{ \N\left(\V Q+\frac{\delta}{2}\Delta\V Q\right)-\N\left(\V Q-\frac{\delta}{2}\Delta\V Q\right)\right\} \V W^{FT}}=k_{B}T\ \partial_{\V Q}\cdot\N+O(\delta^{2}),\label{eq:RFDL}
\end{equation}

\end_inset

which respects the physical units of the problem and minimizes the variance
 of the approximation.
 A one-sided difference approximation can be defined analogously.
\end_layout

\begin_layout Standard
Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RFDN"

\end_inset

 summarizes a scalable implementation of the Euler-Maruyama RFD scheme from
 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

 to solve 
\begin_inset CommandInset ref
LatexCommand eqref
reference "Langevin"

\end_inset

, using a random finite difference similar to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDL"

\end_inset

 to compute the drift.
 Implementation of this scheme requires three solutions of the saddle point
 system 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:saddle"

\end_inset

 and one Lanczos application per timestep.
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Note that the velocity update in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RFDN"

\end_inset

 is equivalent to 
\begin_inset Formula 
\begin{equation}
\V U^{n}=\epsN^{n}\V F^{n}+\frac{k_{B}T}{\delta}\left[\epsN\left(\V Q^{+}\right)-\epsN\left(\V Q^{n}\right)\right]\V W^{FT}+\sqrt{2k_{B}T}\left(\epsN^{1/2}\right)^{n}\V W^{n}\label{eq:RFDshemeN}
\end{equation}

\end_inset

Where 
\begin_inset Formula $\epsN$
\end_inset

 is the 
\begin_inset Formula $\mathcal{O}(\epsilon_{N})$
\end_inset

 approximation to 
\begin_inset Formula $\N$
\end_inset

 made by the iterative solver.
 [Note that in subsequent sections, we will drop the 
\begin_inset Formula $\bar{\cdot}$
\end_inset

 when writing the result of saddle point solves in terms of the grad mobility,
 
\begin_inset Formula $\N$
\end_inset

.]
\end_layout

\begin_layout Plain Layout
We now consider the somewhat delicate issue of selecting an appropriate
 value for 
\begin_inset Formula $\delta$
\end_inset

.
 There are four sources for error introduced in the scheme algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RFDN"

\end_inset

: The truncation error introduced by expanding 
\begin_inset Formula $\N\left(\V Q^{+}\right)$
\end_inset

 as a Taylor series, the truncation error introduced from discretization
 in time, the machine error associated with the precision used, and the
 tolerance of the iterative methods used, 
\begin_inset Formula $\epsilon_{N}$
\end_inset

.
 Note that, we will typically use the same tolerance for both the saddle
 point system and the matrix root calculation.
 The error produced by the RFD terms, in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFDshemeN"

\end_inset

, can be expressed as 
\begin_inset Formula 
\begin{align}
Error & =\norm{\frac{1}{\delta}\av{\left[\epsN\left(\V Q^{+}\right)-\epsN\left(\V Q^{n}\right)\right]\V W^{FT}}-\partial_{\V Q}\cdot\N^{n}}\\
 & =\norm{\frac{1}{\delta}\av{\left[\N\left(\V Q^{+}\right)-\N\left(\V Q^{n}\right)\right]\V W^{FT}+\mathcal{O}(\epsilon_{N})}-\partial_{\V Q}\cdot\N^{n}}\\
 & =\norm{\frac{1}{\delta}\left[\delta\ \partial_{\V Q}\cdot\N^{n}+\mathcal{O}(\delta^{2})+\mathcal{O}(\epsilon_{N})\right]-\partial_{\V Q}\cdot\N^{n}}\\
 & =\mathcal{O}\left(\delta+\frac{\epsilon_{N}}{\delta}\right).\label{eq:RFD_error}
\end{align}

\end_inset

We see that this error in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:RFD_error"

\end_inset

 is clearly minimized when the two terms are on the same order.
 That is, we must take 
\begin_inset Formula $\delta\sim\sqrt{\epsilon_{N}}$
\end_inset

, and hence 
\begin_inset Formula $Error=\mathcal{O}(\sqrt{\epsilon_{N}})$
\end_inset

.
 Note that using a centered difference approximation for the RFD on 
\begin_inset Formula $\N$
\end_inset

 will relax the restrictions on the solver tolerance somewhat, but this
 comes at the cost of requiring an additional saddle point solve per timestep.
 To truly reap the benefits of using inexact iterative methods, we must
 find a way to relax the dependence of 
\begin_inset Formula $\delta$
\end_inset

 on the solver tolerance, 
\begin_inset Formula $\epsilon_{N}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:RFDN"

\end_inset

 Euler-Maruyama-RFD scheme
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Compute RFD terms:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Form 
\begin_inset Formula $\V W^{FT}=\left[\V W_{p}^{FT}\right],$
\end_inset

 where 
\begin_inset Formula 
\[
\V W_{p}^{FT}=k_{B}T\begin{bmatrix}L_{p}^{-1}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
Displace the particles by small random amounts: 
\begin_inset Formula 
\[
\V Q_{p}^{\pm}=\V Q_{p}^{n}\pm\frac{\delta}{2}\begin{bmatrix}L_{p}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:EM_RFD_solve"

\end_inset

Solve 
\shape italic
two
\shape default
 mobility problems for 
\begin_inset Formula $\V U^{+},\V U^{-}$
\end_inset

:
\begin_inset Formula 
\[
\begin{bmatrix}\Mob^{\pm} & -\K^{\pm}\\
-\left(\K^{T}\right)^{\pm} & \V 0
\end{bmatrix}\begin{bmatrix}{\V{\lambda}}^{\pm}\\
\V U^{\pm}
\end{bmatrix}=\begin{bmatrix}\V 0\\
-\V W^{FT}
\end{bmatrix}.
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Compute 
\begin_inset Formula $\left(\Mob^{1/2}\right)^{n}\V W^{n}$
\end_inset

 using a preconditioned Lancoz method or PSE.
\end_layout

\begin_layout Enumerate
Solve mobility problem:
\begin_inset Formula 
\[
\begin{bmatrix}\Mob^{n} & -\K^{n}\\
-\left(\K^{T}\right)^{n} & \V 0
\end{bmatrix}\begin{bmatrix}{\V{\lambda}}^{n}\\
\V U^{n}
\end{bmatrix}=\begin{bmatrix}-\sqrt{\frac{2k_{B}T}{\Delta t}}\left(\Mob^{1/2}\right)^{n}\V W^{n}\\
-\V F^{n}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Enumerate
Update configuration:
\begin_inset Formula 
\[
\V Q^{n+1}=\V Q^{n}+\Delta t\left\{ \V U^{n}+\frac{1}{\delta}(\V U^{+}-\V U^{-})\right\} .
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "Add:Proof"

\end_inset

Proofs of Consistency of Temporal Integrators
\end_layout

\begin_layout Standard
In this appendix we demonstrate that the two temporal integrators presented
 in this work generate the required stochastic drift terms.
 In all of the calculations of this section, we will use index notation
 with the convention of summing over repeated indices.
 We will also use the convention that superscripted indices correspond to
 a matrix inverse, i.e 
\begin_inset Formula $\left[\sM A^{-1}\right]_{ij}\equiv\sM A^{ij}$
\end_inset

.
 To avoid possible confusion with our superscript notation for the time
 level at which an operator is evaluated, we will assume that all terms
 and operators are evaluated at the base configuration 
\begin_inset Formula $\V Q\equiv\V Q^{n}$
\end_inset

 unless otherwise noted.
 We denote partial derivatives with the shorthand notation 
\begin_inset Formula $\partial_{k}\equiv\partial/\partial Q_{k}$
\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "Add:Quat"

\end_inset

Overdamped Langevin Equation using Quaternions
\end_layout

\begin_layout Standard
In principle, any means of representing orientation could be used with the
 techniques detailed in this work.
 In previous work 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

, unit quaternions were found to be a particularly favorable choice, and
 we will use normalized quaternions to represent the orientation 
\begin_inset Formula $\V{\theta}$
\end_inset

 hereafter.
 Here we briefly review key notation and results regarding quaternions;
 details can be found in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 A normalized quaternion is a vector 
\begin_inset Formula $\V{\theta}=\left[s,\V p\right]\in\Set R^{4}$
\end_inset

 such that 
\begin_inset Formula $\norm{\V{\theta}}_{2}=1$
\end_inset

.
 We define an orientation dependent 
\begin_inset Formula $4\times3$
\end_inset

 
\begin_inset Quotes eld
\end_inset

projection
\begin_inset Quotes erd
\end_inset

 matrix 
\begin_inset Formula $\V{\Psi}$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\rot\left(\V{\theta}\right)=\frac{1}{2}\begin{bmatrix}-\V p^{T}\\
s\M I-\M P
\end{bmatrix},
\end{equation}

\end_inset

where 
\begin_inset Formula $\M P$
\end_inset

 is the cross product matrix defined by 
\begin_inset Formula $\M P\V x=\V p\times\V x$
\end_inset

.
 For a configuration, 
\begin_inset Formula $\V Q=\left[\V q,\V{\theta}\right]$
\end_inset

 and a rigid body velocity 
\begin_inset Formula $\V U=\left[\V u,\V{\omega}\right]$
\end_inset

, we introduce a matrix 
\begin_inset Formula 
\begin{equation}
\Rot=\begin{bmatrix}\M I & \M 0\\
\M 0 & \rot
\end{bmatrix},
\end{equation}

\end_inset

so that we may write 
\begin_inset Formula $d\V Q/dt=\M{\Rot}\V U$
\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

 some of us showed that the overdamped Langevin Ito equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "Langevin"

\end_inset

 may be written using unit quaternions as
\begin_inset Formula 
\begin{eqnarray}
\frac{d\V Q_{l}}{dt} & = & \Rot_{li}\N_{ij}\V F_{j}+k_{B}T\ \left(\Rot_{li}\left\{ \partial_{k}\N_{ij}\right\} \Rot_{kj}+\left\{ \partial_{k}\Rot_{li}\right\} \N_{ij}\Rot_{kj}\right)+\sqrt{2k_{B}T}\;\Rot_{li}\N_{it}^{1/2}\sM W_{t}\label{eq:quatLangevin}\\
 & = & \Rot_{li}\circ\left(\N_{ij}\V F_{j}+k_{B}T\ \left\{ \partial_{k}\N_{ij}\right\} \Rot_{kj}+\sqrt{2k_{B}T}\;\N_{it}^{1/2}\sM W_{t}\right)\nonumber \\
 & = & \Rot_{li}\circ\V U_{i},\nonumber 
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\circ$
\end_inset

 denotes the Stratonovich product.
 As shown in 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

, the forces and torques of the system may be written as 
\begin_inset Formula $\V F_{j}=-\M{\Rot}_{kj}\partial_{k}U,$
\end_inset

 where 
\begin_inset Formula $U\left(\V Q\right)$
\end_inset

 is the conservative potential.
 This, combined with the fact that 
\begin_inset Formula $\partial_{k}\Rot_{kj}=0$
\end_inset

, allows us to recognize 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:quatLangevin"

\end_inset

 as having the same form as equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "Langevin"

\end_inset

 but with 
\begin_inset Formula $\N$
\end_inset

 replaced by 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\Rot\N\Rot^{T}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
.
 
\end_layout

\begin_layout Standard
In order to discretize 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:quatLangevin"

\end_inset

, we write an expansion in 
\begin_inset Formula $\Delta t$
\end_inset

 for the procedure which rotates a quaternion 
\begin_inset Formula $\V{\theta}$
\end_inset

 by an angular displacement 
\begin_inset Formula $\V{\omega}\Delta t$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\text{Rotate}\left(\V{\theta}_{k},\V{\omega}_{k}\Delta t\right)\approx\V{\theta}_{k}+\Delta t\rot_{kj}\V{\omega}_{j}-\frac{\Delta t^{2}}{8}\norm{\V{\omega}}_{2}^{2}\V{\theta}_{k}.\label{eq:rotate}
\end{equation}

\end_inset

The second order term in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rotate"

\end_inset

 is responsible for the fact that that a simple (inconsistent) Euler-Maruyama
 scheme without an RFD, using a velocity 
\begin_inset Formula 
\begin{equation}
\V U_{i}=\N_{ij}\V F_{j}+\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{it}^{1/2}\V W_{t}^{n}\label{eq:EM_U}
\end{equation}

\end_inset

to update the configurations to the next time step, will generate the drift
 term 
\begin_inset Formula $\left(k_{B}T\right)\left\{ \partial_{k}\Rot_{li}\right\} \N_{ij}\Rot_{kj}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:quatLangevin"

\end_inset

 to leading order in 
\begin_inset Formula $\Delta t$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "BrownianMultiBlobs"

\end_inset

.
 This is to say that the rotate procedure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rotate"

\end_inset

 naturally captures the Stratonovich product in the second line of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:quatLangevin"

\end_inset

.
 A one-step numerical scheme is first-order weakly accurate if the first
 three moments of the numerical update are correct to 
\begin_inset Formula $O(\D t)$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "MilsteinSDEBook"

\end_inset

; the third moment in our schemes is easily seen to be at least 
\begin_inset Formula $O(\D t^{3/2})$
\end_inset

.
 Hence, to show that the schemes introduced in this work are weakly first
 order in solving 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:quatLangevin"

\end_inset

, we will show that velocity used to update the configurations to the next
 time step is of the form
\begin_inset Formula 
\begin{equation}
\V U_{i}=\N_{ij}\V F_{j}+\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{it}^{1/2}\V W_{t}^{n}+k_{B}T\ \left\{ \partial_{k}\N_{ij}\right\} \Rot_{kj}+\mathcal{R}\left(\D t,\,\D t^{1/2}\right),\label{eq:EM_RFD_U}
\end{equation}

\end_inset

where the notation 
\begin_inset Formula $\mathcal{R}\left(a,b^{1/2}\right)$
\end_inset

 denotes a Gaussian random error term with mean 
\begin_inset Formula $O\left(a\right)$
\end_inset

, and variance 
\begin_inset Formula $O\left(b\right)$
\end_inset

.
 Notice that the leading order term in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:EM_RFD_U"

\end_inset

, the Brownian velocity 
\begin_inset Formula $\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{it}^{1/2}\V W_{t}^{n}$
\end_inset

, controls the second moment of the velocity update.
 This term is easily identified in the velocity update produced by the schemes
 introduced in this work.
 The main difficulty is showing that both schemes generate in expectation
 value the required drift term 
\begin_inset Formula $k_{B}T\ \left\{ \partial_{k}\N_{ij}\right\} \Rot_{kj}$
\end_inset

 for sufficiently small 
\begin_inset Formula $\D t$
\end_inset

.
 For this, we will use the chain rule to expand the derivative,
\begin_inset Formula 
\begin{align}
\partial_{k}\N_{ij}= & -\N_{im}\left\{ \partial_{k}\N^{ml}\right\} \N_{lj}=-\N_{im}\left(\partial_{k}\left\{ \K_{pm}\Mob^{pq}\K_{ql}\right\} \right)\N_{lj}\nonumber \\
= & -\N_{im}\left\{ \partial_{k}\K_{pm}\right\} \Mob^{pq}\K_{ql}\N_{lj}-\N_{im}\K_{pm}\left\{ \partial_{k}\Mob^{pq}\right\} \K_{ql}\N_{lj}-\N_{im}\K_{pm}\Mob^{pq}\left\{ \partial_{k}\K_{ql}\right\} \N_{lj}\nonumber \\
= & -\N_{im}\left\{ \partial_{k}\K_{sm}\right\} \Mob^{sq}\K_{ql}\N_{lj}\label{eq:DNindex}\\
 & +\N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\Mob_{rs}\right\} \Mob^{sq}\K_{ql}\N_{lj}\nonumber \\
 & -\N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\K_{rl}\right\} \N_{lj}.\nonumber 
\end{align}

\end_inset

Note that the expression for 
\begin_inset Formula $\left(\partial_{\V Q}\cdot\N\right)_{i}$
\end_inset

 can be obtained by replacing every instance of the index 
\begin_inset Formula $k$
\end_inset

 with 
\begin_inset Formula $j$
\end_inset

 in the above.
 For clarity but without loss of generality, we take 
\begin_inset Formula $\V F=\V 0$
\end_inset

 hereafter.
 Note that a nonzero value of 
\begin_inset Formula $\V F$
\end_inset

 may affect the variance of a velocity update and thus the accuracy of the
 scheme for finite values of 
\begin_inset Formula $\D t$
\end_inset

.
 Still, the weak 
\shape italic
order
\shape default
 of accuracy of the schemes considered will be maintained for nonzero 
\begin_inset Formula $\V F$
\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "Add:tractionDense"

\end_inset

Traction-Corrected Euler-Maruyama Scheme
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
If exact linear algebra is used, we may write the steps of algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

 using the grand mobility matrix 
\begin_inset Formula $\N$
\end_inset

.
 This is shown in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:Ntraction"

\end_inset

.
\end_layout

\begin_layout Plain Layout
Note that in step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:U"

\end_inset

, we expand the rotate procedure to higher order than in 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:URFD"

\end_inset

 due to the 
\begin_inset Formula $\mathcal{O}(\sqrt{\Delta t})$
\end_inset

 term in 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:Udef"

\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:Ntraction"

\end_inset

 Traction Corrected Euler-Maruyama Scheme: Using Grand Mobility 
\begin_inset Formula $\N$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Compute relevant quantities for capturing drift:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Note Note
status open

\begin_layout Plain Layout
Do you feel these floats are really necessary? We already have this earlier
 without the indices, and I am not sure the indices add much.
 I have indicated which parts are actually providing new information and
 I think that just including them in the main text as simple equations is
 enough.
 Keep this Algorithm by inserting it into a Note/Comment inset, so it is
 saved for future.
\end_layout

\begin_layout Plain Layout
UNFINISHED: Need to make this decision and address.
\end_layout

\end_inset

Form 
\begin_inset Formula $\V W^{FT}=\left\{ \V W_{p}^{FT}\right\} ,$
\end_inset

 where 
\begin_inset Formula 
\[
\V W_{p}^{FT}=k_{B}T\begin{bmatrix}L_{p}^{-1}\V W_{p}^{f}\\
\V W_{p}^{\tau}
\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Enumerate
Solve mobility problem:
\begin_inset Formula 
\begin{align*}
\V U_{l}^{\text{RFD}} & =\N_{lj}{\V W}_{j}^{FT}\\
\V{\lambda}_{s}^{\text{RFD}} & =\Mob^{sq}\K_{ql}\V U_{l}^{\text{RFD}}=\Mob^{sq}\K_{ql}\N_{lj}{\V W}_{j}^{FT}
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate
Update configurations to 
\begin_inset Formula $\V Q^{\pm}$
\end_inset

:
\begin_inset Note Note
status open

\begin_layout Plain Layout
This provides new information.
 But doesn't it need to be to second order for the rotation or it does not
 matter here.
 If it does not matter write something like 
\begin_inset Formula $+O(\delta^{2})$
\end_inset

 to indicate hot's are not given.
\end_layout

\end_inset


\begin_inset Formula 
\begin{align*}
\V q_{k}^{\pm} & =\V q_{k}^{n}\pm\frac{\delta}{2}L_{p}\V W_{k}^{f}\\
\V{\theta}_{k}^{\pm} & =\V{\theta}_{k}^{n}\pm\frac{\delta}{2}\rot_{kj}\V W_{j}^{\tau}+O(\delta^{2})
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate
Compute the force-drift, 
\begin_inset Formula $\V D^{F}$
\end_inset

, and the slip-drift, 
\begin_inset Formula $\V D^{S}$
\end_inset

:
\begin_inset Formula 
\begin{align*}
\V D_{m}^{F} & =\frac{1}{\delta}\left[\K_{sm}\left(\V Q^{+}\right)-\K_{sm}\left(\V Q^{-}\right)\right]\V{\lambda}_{s}^{\text{RFD}}\\
\V D_{r}^{S} & =\frac{1}{\delta}\left[\Mob_{rs}\left(\V Q^{+}\right)-\Mob_{rs}\left(\V Q^{-}\right)\right]\V{\lambda}_{s}^{\text{RFD}}-\frac{1}{\delta}\left[\K_{rl}\left(\V Q^{+}\right)-\K_{rl}\left(\V Q^{-}\right)\right]\V U_{l}^{\text{RFD}}
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Compute 
\begin_inset Formula $\Mob_{rj}^{1/2}\V W_{j}^{n}$
\end_inset

 using a preconditioned Lancoz method or PSE.
\end_layout

\begin_layout Enumerate
Solve mobility problem:
\begin_inset Formula 
\begin{align*}
\V U_{i}^{n} & =\N_{ij}\V F_{j}^{n}-\N_{im}\V D_{m}^{F}+\N_{im}\K_{pm}\Mob^{pr}\left(\V D_{r}^{S}+\sqrt{\frac{2k_{B}T}{\Delta t}}\Mob_{rj}^{1/2}\V W_{j}^{n}\right)\\
 & =\N_{ij}\V F_{j}^{n}-\N_{im}\V D_{m}^{F}+\N_{im}\K_{pm}\Mob^{pr}\V D_{r}^{S}+\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{ij}^{1/2}\V W_{j}^{n}
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate
Update configurations to 
\begin_inset Formula $\V Q^{n+1}$
\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
And this provides new information
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{align*}
\V q_{k}^{n+1} & =\V q_{k}^{n}+\Delta t\V u_{k}^{n}\\
\V{\theta}_{k}^{n+1} & =\V{\theta}_{k}^{n}+\Delta t\rot_{kj}\V{\omega}_{j}^{n}-\frac{\Delta t^{2}}{8}\norm{\V{\omega}^{n}}_{2}^{2}\V{\theta}_{k}^{n}
\end{align*}

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is immediate from the discussion in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Nhalf"

\end_inset

, that the Brownian velocities produced by Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

 are 
\begin_inset Formula $\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{ij}^{1/2}\V W_{j}^{n}$
\end_inset

 to leading order in 
\begin_inset Formula $\D t$
\end_inset

, and hence produce the correct second moment.
 We will now show that the velocity produced in step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:Udef"

\end_inset

 of Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:traction"

\end_inset

 is such that 
\begin_inset Formula 
\begin{equation}
\av{\V U_{i}^{n}}=k_{B}T\ \left\{ \partial_{k}\N_{ij}\right\} \Rot_{kj}+O\left(\delta^{2}\right).\label{eq:EM_drift_desired}
\end{equation}

\end_inset

First, we may write step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:Udef"

\end_inset

 as
\begin_inset Formula 
\begin{align*}
\V U_{i}^{n} & =-\N_{im}\V D_{m}^{F}+\N_{im}\K_{pm}\Mob^{pr}\left(\V D_{r}^{S}+\sqrt{\frac{2k_{B}T}{\Delta t}}\Mob_{rj}^{1/2}\V W_{j}^{n}\right)\\
 & =-\N_{im}\V D_{m}^{F}+\N_{im}\K_{pm}\Mob^{pr}\V D_{r}^{S}+\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{ij}^{1/2}\V W_{j}^{n}
\end{align*}

\end_inset

and thus
\begin_inset Formula 
\begin{equation}
\av{\V U_{i}^{n}}=-\N_{im}\av{\V D_{m}^{F}}+\N_{im}\K_{pm}\Mob^{pr}\av{\V D_{r}^{S}}.\label{eq:meanU}
\end{equation}

\end_inset

We can expand the quantities 
\begin_inset Formula $\V D_{m}^{F}$
\end_inset

 and 
\begin_inset Formula $\V D_{r}^{S}$
\end_inset

, defined in step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:DFDS"

\end_inset

, using the definition of 
\begin_inset Formula $\V{\lambda}^{\text{RFD}}$
\end_inset

 from step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:ULam"

\end_inset

,
\begin_inset Formula 
\begin{align*}
\V U_{l}^{\text{RFD}} & =\N_{lj}{\V W}_{j}^{FT}\\
\V{\lambda}_{s}^{\text{RFD}} & =\Mob^{sq}\K_{ql}\V U_{l}^{\text{RFD}}=\Mob^{sq}\K_{ql}\N_{lj}{\V W}_{j}^{FT}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Beginning with 
\begin_inset Formula $\V D_{m}^{F}$
\end_inset

, 
\begin_inset Formula 
\begin{align}
\av{\V D_{m}^{F}} & =\frac{1}{\delta}\av{\left\{ \K_{sm}\left(\V Q^{+}\right)-\K_{sm}\left(\V Q^{-}\right)\right\} \Mob^{sq}\K_{ql}\N_{lj}{\V W}_{j}^{FT}}\label{eq:lambdaUse}\\
 & =\left\{ \partial_{k}\K_{sm}\right\} \Mob^{sq}\K_{ql}\N_{lj}\av{\Delta\V Q_{k}\ {\V W}_{j}^{FT}}+O(\delta^{2}).\label{eq:DFtrp}
\end{align}

\end_inset

Using the expansion for the rotation procedure from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rotate"

\end_inset

, we may write 
\begin_inset Formula $\Delta\V Q_{k}=\left[\D{\V q}_{k},\D{\theta}_{k}\right]$
\end_inset

 as 
\begin_inset Formula 
\begin{align*}
\D{\V q_{k}} & =\frac{\delta}{2}L_{p}\V W_{k}^{f}\\
\D{\V{\theta}_{k}} & =\frac{\delta}{2}\rot_{kl}\V W_{l}^{\tau}+\mathcal{R}\left(\delta^{2},\delta^{2}\right),
\end{align*}

\end_inset

from which it is straightforward to verify that 
\begin_inset Formula 
\begin{equation}
\av{\Delta\V Q_{k}\ {\V W}_{j}^{FT}}=k_{B}T\ \Rot_{kj}+O(\delta^{2}).\label{eq:DQW}
\end{equation}

\end_inset

Using equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DFtrp"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DQW"

\end_inset

, we see that the terms produced by 
\begin_inset Formula $\V D^{F}$
\end_inset

 give one part of the required stochastic drift term, 
\begin_inset Formula 
\begin{equation}
\av{\V D_{m}^{F}}=k_{B}T\ \left\{ \partial_{k}\K_{sm}\right\} \Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}+O(\delta^{2}).\label{eq:DFavg}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now, for the contributions from terms involving 
\begin_inset Formula $\V D_{r}^{S}$
\end_inset

, we have 
\begin_inset Formula 
\begin{align}
\av{\V D_{r}^{S}}= & \frac{1}{\delta}\av{\left\{ \Mob_{rs}\left(\V Q^{+}\right)-\Mob_{rs}\left(\V Q^{-}\right)\right\} \Mob^{sq}\K_{ql}\N_{lj}{\V W}_{j}^{FT}}\nonumber \\
 & -\frac{1}{\delta}\av{\left\{ \K_{rl}\left(\V Q^{+}\right)-\K_{rl}\left(\V Q^{-}\right)\right\} \N_{lj}{\V W}_{j}^{FT}}\nonumber \\
= & \left(\left\{ \partial_{k}\Mob_{rs}\right\} \Mob^{sq}\K_{ql}-\left\{ \partial_{k}\K_{rl}\right\} \right)\N_{lj}\av{\Delta\V Q_{k}\ {\V W}_{j}^{FT}}+O(\delta^{2}),\label{eq:DStrp}
\end{align}

\end_inset

and hence, using equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DStrp"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DQW"

\end_inset

, we see that from 
\begin_inset Formula $\M D^{S}$
\end_inset

 we get two more pieces of the required stochastic drift term, 
\begin_inset Formula 
\begin{align}
\av{\V D_{r}^{S}} & =k_{B}T\ \left(\left\{ \partial_{k}\Mob_{rs}\right\} \Mob^{sq}\K_{ql}-\left\{ \partial_{k}\K_{rl}\right\} \right)\N_{lj}\Rot_{kj}+O(\delta^{2}).\label{eq:DSavg}
\end{align}

\end_inset

Plugging the results from equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DFavg"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DSavg"

\end_inset

 into equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:meanU"

\end_inset

, and using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DNindex"

\end_inset

, gives 
\begin_inset Formula 
\begin{align}
\av{\V U_{i}^{n}}= & -\N_{im}\av{\V D_{m}^{F}}+\N_{im}\K_{pm}\Mob^{pr}\av{\V D_{r}^{S}}+O(\delta^{2})\\
= & -k_{B}T\ (\N_{im}\left\{ \partial_{k}\K_{sm}\right\} \Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}\nonumber \\
 & +\N\K_{pm}\Mob^{pr}\left\{ \partial_{k}\Mob_{rs}\right\} \Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}\nonumber \\
 & -\N\K_{pm}\Mob^{pr}\left\{ \partial_{k}\K_{rl}\right\} \N_{lj}\Rot_{kj})+O(\delta^{2})\nonumber \\
= & k_{B}T\ \left\{ \partial_{k}\N_{ij}\right\} \Rot_{kj}+O(\delta^{2}),\nonumber 
\end{align}

\end_inset

where the last equality comes directly from equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DNindex"

\end_inset

.
 This is the desired result 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:EM_drift_desired"

\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "Add:SlipDense"

\end_inset

Slip-Corrected Trapezoidal Scheme
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
If exact linear algebra is used, we may write the steps of algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

 using the grand mobility matrix 
\begin_inset Formula $\N$
\end_inset

.
 This is shown in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:STdense"

\end_inset

.
 Further, for simplicity, in this section we will use the shorthand notation
 
\begin_inset Formula $L\slipW\equiv\left\{ L_{p}\breve{\V W_{p}}\right\} $
\end_inset

, where ,
\begin_inset Formula $L$
\end_inset

, acts like a scalar and denotes that the quantity has units of length.
 This is tantamount to the case where all bodies have the same size.
 
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:STdense"

\end_inset

 Slip Corrected Trapezoidal Scheme
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Compute relevant quantities for capturing drift:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Solve mobility problem:
\begin_inset Note Note
status open

\begin_layout Plain Layout
Same comment here, is this long space-hogging detailed summary really needed?
\end_layout

\end_inset


\begin_inset Formula 
\[
\D{\V Q_{j}^{\text{RFD}}}=L\N_{jl}\K_{lq}\Mob^{qs}\slipW_{s}
\]

\end_inset


\end_layout

\begin_layout Enumerate
Update configurations to 
\begin_inset Formula $\V Q^{\pm}$
\end_inset

:
\begin_inset Formula 
\begin{align*}
\V q_{k}^{\pm} & =\V q_{k}^{n}\pm\frac{\delta}{2}\D{\V q_{k}^{\text{RFD}}}\\
\V{\theta}^{\pm} & =\V{\theta}_{k}^{n}\pm\frac{\delta}{2}\rot_{kj}\D{\V{\theta}_{j}^{\text{RFD}}}+O(\delta^{2})
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate
Compute the force-drift, 
\begin_inset Formula $\V D^{F}$
\end_inset

, and the slip-drift, 
\begin_inset Formula $\V D^{S}$
\end_inset

:
\begin_inset Formula 
\begin{align*}
\V D_{m}^{F} & =\frac{k_{B}T}{\delta L}\left[\K_{pm}\left(\V Q^{+}\right)-\K_{pm}\left(\V Q^{-}\right)\right]\slipW_{p}\\
\V D_{r}^{S} & =\frac{k_{B}T}{\delta L}\left[\Mob_{rt}\left(\V Q^{+}\right)-\Mob_{rt}\left(\V Q^{-}\right)\right]\slipW_{t}
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Compute 
\begin_inset Formula $\Mob_{st}^{1/2}\ \V W_{t}^{n}$
\end_inset

 using a preconditioned Lancoz method or PSE.
\end_layout

\begin_layout Enumerate
Solve mobility problem:
\begin_inset Formula 
\begin{align*}
\V U_{j}^{n} & =\N_{jm}\V F_{m}^{n}+\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{jl}\K_{ql}\Mob^{qs}\Mob_{su}^{1/2}\ \V W_{u}^{n}
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate
Update configurations to 
\begin_inset Formula $\widetilde{\V Q}$
\end_inset

: 
\begin_inset Formula 
\begin{align*}
\tilde{\V q}_{k} & =\V q_{k}^{n}+\Delta t\V u_{k}^{n}\\
\tilde{\V{\theta}}_{k} & =\V{\theta}_{k}^{n}+\Delta t\rot_{kj}\V{\omega}_{j}^{n}
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate
Solve mobility problem:
\begin_inset Formula 
\begin{align*}
\widetilde{\V U}_{i} & =\aN_{im}\widetilde{\V F}_{m}-2\aN_{im}\V D_{m}^{F}+2\aN_{im}\aK_{pm}\aMob^{pr}\V D_{r}^{S}+\sqrt{\frac{2k_{B}T}{\Delta t}}\aN_{im}\aK_{pm}\aMob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n}
\end{align*}

\end_inset


\end_layout

\begin_layout Enumerate
Update configurations to 
\begin_inset Formula $\V Q^{n+1}$
\end_inset

: 
\begin_inset Formula 
\begin{align*}
\V q_{k}^{n+1} & =\V q_{k}^{n}+\frac{\Delta t}{2}\left[\widetilde{\V u_{k}}+\V u_{k}^{n}\right]\\
\V{\theta}_{k}^{n+1} & =\V{\theta}_{k}^{n}+\Delta t\rot_{kj}\left[\widetilde{\V{\omega}_{j}}+\V{\omega}_{j}^{n}\right]-\frac{\Delta t^{2}}{8}\norm{\V{\omega}^{n+1}+\V{\omega}^{n}}_{2}^{2}\V{\theta}_{k}^{n}
\end{align*}

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We must show that the velocity used to update the position in the corrector
 step in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

,
\begin_inset Formula 
\begin{equation}
\V U_{i}^{\left(c\right)}=\frac{1}{2}\left(\widetilde{\V U}_{i}+\V U_{i}^{n}\right),
\end{equation}

\end_inset

satisfies 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:EM_RFD_U"

\end_inset

 in law to leading order.
 We first show that the predictor-corrector update already gives part of
 the required drift term.
 For this we set 
\begin_inset Formula $\V D^{F}=\V D^{S}=\V 0$
\end_inset

 (recall that we take 
\begin_inset Formula $\V F=0$
\end_inset

 for simplicity), and show that to leading order in 
\begin_inset Formula $\Delta t$
\end_inset

, the velocity update in step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:unun1"

\end_inset

 of Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

 is such that 
\begin_inset Foot
status open

\begin_layout Plain Layout
Note that this quantity gives the drift term produced by equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IncTrap2"

\end_inset

 in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Slip"

\end_inset

.
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\av{\V U_{i}^{\left(c\right)}}=-k_{B}T\ \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\K_{rl}\right\} \N_{lj}\Rot_{kj}+O\left(\D t\right).\label{eq:IncSTdrift}
\end{equation}

\end_inset

To show this we first write steps 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:unT"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:unp1T"

\end_inset

 as 
\begin_inset Formula 
\begin{align}
\V U_{j}^{n} & =\sqrt{\frac{2k_{B}T}{\Delta t}}\ \N_{jl}\K_{ql}\Mob^{qs}\Mob_{su}^{1/2}\ \V W_{u}^{n},\label{eq:UnSTproof}\\
\widetilde{\V U}_{i} & =\sqrt{\frac{2k_{B}T}{\Delta t}}\ \aN_{im}\aK_{pm}\aMob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n},
\end{align}

\end_inset

and write the velocity update of step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:unun1"

\end_inset

 as 
\begin_inset Formula 
\begin{align}
\sqrt{\frac{2\Delta t}{k_{B}T}}\,\V U_{i}^{\left(c\right)}= & \N_{im}\K_{pm}\Mob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n}+\aN_{im}\aK_{pm}\aMob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n}\nonumber \\
= & \N_{im}\K_{pm}\Mob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n}\nonumber \\
 & +\left(\N_{im}\K_{pm}\Mob^{pr}+\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \ \Delta\widetilde{\V Q}_{k}+O\left(\Delta\widetilde{\V Q}^{2}\right)\right)\Mob_{rt}^{1/2}\V W_{t}^{n}\label{eq:STtimesplit}\\
= & 2\N_{im}\K_{pm}\Mob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n}+\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rt}^{1/2}\ \Delta\widetilde{\V Q}_{k}\V W_{t}^{n}+\mathcal{R}\left(\D t^{3/2},\D t\right)\nonumber \\
= & 2\N_{it}^{1/2}\V W_{t}^{n}+\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rt}^{1/2}\ \Delta\widetilde{\V Q}_{k}\V W_{t}^{n}+\mathcal{R}\left(\D t^{3/2},\D t\right).\label{eq:STlemFinal}
\end{align}

\end_inset

In equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:STtimesplit"

\end_inset

, we have used the fact that all operators with tilde are evaluated at 
\begin_inset Formula $\widetilde{\V Q}$
\end_inset

, with 
\begin_inset Formula $\Delta\widetilde{\V Q}=\widetilde{\V Q}-\V Q^{n}$
\end_inset

.
 
\end_layout

\begin_layout Standard
All that remains is to compute, 
\begin_inset Formula 
\begin{align}
\av{\V U_{i}^{\left(c\right)}}= & \sqrt{\frac{k_{B}T}{2\Delta t}}\ \partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rt}^{1/2}\av{\Delta\widetilde{\V Q}_{k}\V W_{t}^{n}}+O\left(\D t\right).\label{eq:meanUU}
\end{align}

\end_inset

Using the expansion for the rotate procedure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rotate"

\end_inset

, we may write
\begin_inset Formula 
\begin{align*}
\D{\tilde{\V Q}_{k}} & =\Delta t\Rot_{kj}\V U_{j}^{n}+\mathcal{R}\left(\D t^{2},\D t^{2}\right),
\end{align*}

\end_inset

which combined with 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UnSTproof"

\end_inset

 gives 
\begin_inset Formula 
\begin{align}
\av{\Delta\widetilde{\V Q}_{k}\V W_{t}^{n}}= & \sqrt{2\Delta tk_{B}T}\ \Rot_{kj}\N_{jl}\K_{ql}\Mob^{qs}\Mob_{su}^{1/2}\av{\V W_{u}^{n}\V W_{t}^{n}}+O(\D t^{2})\label{eq:DQtil}\\
= & \sqrt{2\Delta tk_{B}T}\ \Rot_{kj}\N_{jl}\K_{ql}\Mob^{qs}\Mob_{st}^{1/2}+O(\D t^{2}),\nonumber 
\end{align}

\end_inset

where we used 
\begin_inset Formula $\av{\V W_{u}^{n}\V W_{t}^{n}}=\delta_{tu}$
\end_inset

.
 Hence, equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:meanUU"

\end_inset

 becomes,
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Rewrote massive original 
\begin_inset Formula 
\begin{align}
\av{\frac{1}{2}\left[\widetilde{\V U}_{i}+\V U_{i}^{n}\right]}= & \sqrt{\frac{k_{B}T}{2\Delta t}}\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rt}^{1/2}\left[\sqrt{2\Delta tk_{B}T}\ \Rot_{kj}\N_{jl}\K_{ql}\Mob^{qs}\Mob_{st}^{1/2}\right]\\
= & k_{B}T\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rt}^{1/2}\Mob_{ts}^{1/2}\Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}\\
= & k_{B}T\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rs}\Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}\\
= & k_{B}T\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \delta_{rq}\K_{ql}\N_{lj}\Rot_{kj}\\
= & k_{B}T\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \K_{rl}\N_{lj}\Rot_{kj}\\
= & \hspace{0.5cm}k_{B}T\left\{ \partial_{k}\N_{im}\right\} \left[\K_{pm}\Mob^{pr}\K_{rl}\right]\N_{lj}\Rot_{kj}\\
 & +k_{B}T\N_{im}\left\{ \partial_{k}\K_{pm}\right\} \Mob^{pr}\K_{rl}\N_{lj}\Rot_{kj}\nonumber \\
 & +k_{B}T\N_{im}\K_{pm}\left\{ \partial_{k}\Mob^{pr}\right\} \K_{rl}\N_{lj}\Rot_{kj}\nonumber \\
= & \hspace{0.5cm}k_{B}T\left\{ \partial_{k}\N_{im}\right\} \left[\N^{ml}\right]\N_{lj}\Rot_{kj}\label{-1}\\
 & +k_{B}T\N_{im}\left\{ \partial_{k}\K_{pm}\right\} \Mob^{pr}\K_{rl}\N_{lj}\Rot_{kj}\nonumber \\
 & +k_{B}T\N_{im}\K_{pm}\left\{ \partial_{k}\Mob^{pr}\right\} \K_{rl}\N_{lj}\Rot_{kj}\nonumber \\
= & \hspace{0.5cm}k_{B}T\left\{ \partial_{k}\N_{im}\right\} \Rot_{km}\label{eq:DN3term-1}\\
 & +k_{B}T\N_{im}\left\{ \partial_{k}\K_{pm}\right\} \Mob^{pr}\K_{rl}\N_{lj}\Rot_{kj}\nonumber \\
 & +k_{B}T\N_{im}\K_{pm}\left\{ \partial_{k}\Mob^{pr}\right\} \K_{rl}\N_{lj}\Rot_{kj}\nonumber \\
= & -k_{B}T\ \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\K_{rl}\right\} \N_{lj}\Rot_{kj}\label{eq:DKlast-1}
\end{align}

\end_inset

to split in two and shorten, but it still needs error terms included or
 limit...clean it up.
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{align}
\av{\V U_{i}^{\left(c\right)}}= & k_{B}T\ \partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rt}^{1/2}\Mob_{ts}^{1/2}\Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}+O\left(\D t\right)\\
= & k_{B}T\ \partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rs}\Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}+O\left(\D t\right)\nonumber \\
= & k_{B}T\ \partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \K_{rl}\N_{lj}\Rot_{kj}+O\left(\D t\right)\nonumber 
\end{align}

\end_inset

where we used that 
\begin_inset Formula $\Mob_{rs}\Mob^{sq}=\delta_{rq}$
\end_inset

.
 After expanding 
\begin_inset Formula $\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} $
\end_inset

 using the chain rule and recalling that 
\begin_inset Formula $\K_{pm}\Mob^{pr}\K_{rl}=\N^{ml}$
\end_inset

, we get
\begin_inset Formula 
\begin{align}
\av{\V U_{i}^{\left(c\right)}}= & k_{B}T\ \big(\left\{ \partial_{k}\N_{im}\right\} \Rot_{km}\label{eq:DN3term-1-1}\\
 & \qquad+\N_{im}\left\{ \partial_{k}\K_{pm}\right\} \Mob^{pr}\K_{rl}\N_{lj}\Rot_{kj}\nonumber \\
 & \qquad+\N_{im}\K_{pm}\left\{ \partial_{k}\Mob^{pr}\right\} \K_{rl}\N_{lj}\Rot_{kj}\big)+O\left(\D t\right)\nonumber \\
= & -k_{B}T\ \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\K_{rl}\right\} \N_{lj}\Rot_{kj}+O\left(\D t\right).\label{eq:DKlast-1-1}
\end{align}

\end_inset

where we have used 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DNindex"

\end_inset

.
 This gives the desired result 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IncSTdrift"

\end_inset

.
 
\end_layout

\begin_layout Standard
We now include the contribution from nonzero 
\begin_inset Formula $\V D^{F}$
\end_inset

 and 
\begin_inset Formula $\V D^{S}$
\end_inset

 to show that 
\begin_inset Formula $\V U_{i}^{\left(c\right)}$
\end_inset

 satisfies equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:EM_RFD_U"

\end_inset

 as desired.
 Including the contributions from 
\begin_inset Formula $\V D^{F}$
\end_inset

and 
\begin_inset Formula $\V D^{S}$
\end_inset

, we may write the velocity update of step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:unun1"

\end_inset

 as,
\begin_inset Formula 
\begin{align}
\V U_{i}^{\left(c\right)}= & -\aN_{im}\V D_{m}^{F}+\aN_{im}\aK_{pm}\aMob^{pr}\V D_{r}^{S}\nonumber \\
 & +\sqrt{\frac{k_{B}T}{2\Delta t}}\N_{im}\K_{pm}\Mob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n}+\sqrt{\frac{k_{B}T}{2\Delta t}}\aN_{im}\aK_{pm}\aMob^{pr}\Mob_{rt}^{1/2}\V W_{t}^{n}.
\end{align}

\end_inset

Using equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:STlemFinal"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DQtil"

\end_inset

, we may write this as 
\begin_inset Formula 
\begin{align}
\V U_{i}^{\left(c\right)}= & -\aN_{im}\V D_{m}^{F}+\aN_{im}\aK_{pm}\aMob^{pr}\V D_{r}^{S}+\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{it}^{1/2}\V W_{t}^{n}\label{eq:slipTEMP}\\
 & +\partial_{k}\left\{ \N_{im}\K_{pm}\Mob^{pr}\right\} \Mob_{rt}^{1/2}\left(\Rot_{kj}\N_{jl}\K_{ql}\Mob^{qs}\Mob_{su}^{1/2}\V W_{u}^{n}\V W_{t}^{n}\right)+\mathcal{R}\left(\D t,\D t^{1/2}\right).\nonumber 
\end{align}

\end_inset

In this form, it is easy to see that the scheme produces the correct Brownian
 velocity, 
\begin_inset Formula $\sqrt{\frac{2k_{B}T}{\Delta t}}\N_{it}^{1/2}\V W_{t}^{n}$
\end_inset

, and all that is left to verify is the first moment.
 Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IncSTdrift"

\end_inset

 allows us to immediately write the mean of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slipTEMP"

\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\av{\V U_{i}^{\left(c\right)}}= & \av{-\aN_{im}\V D_{m}^{F}+\aN_{im}\aK_{pm}\aMob^{pr}\V D_{r}^{S}}\label{eq:slipUUfinal}\\
 & -k_{B}T\ \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\K_{rl}\right\} \N_{lj}\Rot_{kj}+O\left(\D t\right).\nonumber 
\end{align}

\end_inset


\end_layout

\begin_layout Standard
We now examine the terms involving 
\begin_inset Formula $\V D_{m}^{F}$
\end_inset

 and 
\begin_inset Formula $\V D_{r}^{S}$
\end_inset

, separately.
 First, we note that using the expanded rotate procedure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rotate"

\end_inset

, steps 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:QpmT"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:UrfdT"

\end_inset

 in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

 give
\begin_inset Formula 
\begin{equation}
\V Q_{k}^{\pm}-\V Q_{k}=\pm\delta\ \Rot_{kj}\Delta\V Q_{k}^{\text{RFD}}+\mathcal{R}\left(\delta^{2},\delta^{2}\right)=\pm\delta\ \Rot_{kj}\N_{jl}\K_{lq}\Mob^{qs}\slipW_{s}^{D}+\mathcal{R}\left(\delta^{2},\delta^{2}\right),\label{eq:DeltaQref}
\end{equation}

\end_inset

Using the definition of 
\begin_inset Formula $\V D_{m}^{F}$
\end_inset

 from step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:DFDS2"

\end_inset

 of Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

, 
\begin_inset Formula 
\begin{align}
-\aN_{im}\V D_{m}^{F}= & -\frac{1}{\delta}\ \aN_{im}\left\{ \K_{pm}\left(\V Q^{+}\right)-\K_{pm}\left(\V Q^{-}\right)\right\} \slipW_{p}^{F}\nonumber \\
= & -\aN_{im}\left\{ \partial_{k}\K_{pm}\right\} \ \Rot_{kj}\Delta\V Q_{k}^{RFD}\slipW_{p}^{F}+\mathcal{R}\left(\delta^{2},\delta^{2}\right)\nonumber \\
= & -\N_{im}\left\{ \partial_{k}\K_{pm}\right\} \ \Rot_{kj}\N_{jl}\K_{lq}\Mob^{qs}\slipW_{s}^{D}\slipW_{p}^{F}+\mathcal{R}\left(\D t,\D t^{1/2}\right)+\mathcal{R}\left(\delta^{2},\delta^{2}\right),\label{eq:DFexpand}
\end{align}

\end_inset

where we used 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DeltaQref"

\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DFexpand"

\end_inset

.
 In expectation, we get the drift term 
\begin_inset Formula 
\begin{align}
\av{-\aN_{im}\V D_{m}^{F}}= & -\N_{im}\left\{ \partial_{k}\K_{pm}\right\} \av{\slipW_{s}^{D}\slipW_{p}^{F}}\Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}+O\left(\delta^{2}\right)+O\left(\D t\right)\nonumber \\
= & -k_{B}T\ \N_{im}\left\{ \partial_{k}\K_{pm}\right\} \Mob^{pq}\K_{ql}\N_{lj}\Rot_{kj}+O\left(\delta^{2}\right)+O\left(\D t\right),\label{eq:DFfin}
\end{align}

\end_inset

where we have used that 
\begin_inset Formula $\av{\slipW_{s}^{D}\slipW_{p}^{F}}=k_{B}T\delta_{sp}$
\end_inset

.
\end_layout

\begin_layout Standard
Similarly, using the definition of 
\begin_inset Formula $\V D_{r}^{S}$
\end_inset

 from step 
\begin_inset CommandInset ref
LatexCommand ref
reference "step:DFDS2"

\end_inset

 of Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sliptrap"

\end_inset

, 
\begin_inset Formula 
\begin{align}
\aN_{im}\aK_{pm}\aMob^{pr}\V D_{r}^{S}= & \frac{1}{\delta}\ \aN_{im}\aK_{pm}\aMob^{pr}\left\{ \Mob_{rt}\left(\V Q^{+}\right)-\Mob_{rt}\left(\V Q^{-}\right)\right\} \slipW_{t}^{F}\label{eq:DSapprox}\\
= & \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\Mob_{rt}\right\} \ \Rot_{kj}\Delta\V Q_{k}^{RFD}\slipW_{t}^{F}+\mathcal{R}\left(\D t,\D t^{1/2}\right)+\mathcal{R}\left(\delta^{2},\delta^{2}\right).\nonumber 
\end{align}

\end_inset

Hence, taking the mean of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DSapprox"

\end_inset

, gives 
\begin_inset Formula 
\begin{align}
\av{\aN_{im}\aK_{pm}\aMob^{pr}\V D_{r}^{S}}= & \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\Mob_{rt}\right\} \Rot_{kj}\av{\Delta\V Q_{k}^{RFD}\slipW_{t}^{F}}+O\left(\D t\right)+O(\delta^{2})\nonumber \\
= & \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\Mob_{rt}\right\} \av{\slipW_{s}^{D}\slipW_{t}^{F}}\Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}+O\left(\D t\right)+O(\delta^{2})\nonumber \\
= & k_{B}T\ \N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\Mob_{rs}\right\} \Mob^{sq}\K_{ql}\N_{lj}\Rot_{kj}+O\left(\D t\right)+O(\delta^{2}).\label{eq:DSfin}
\end{align}

\end_inset

Combining equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DNindex"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DSfin"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DFfin"

\end_inset

, we may write 
\begin_inset Formula 
\begin{eqnarray}
\av{-\aN_{im}\V D_{m}^{F}+\aN_{im}\aK_{pm}\aMob^{pr}\V D_{r}^{S}} & = & k_{B}T\ \left(\left\{ \partial_{k}\N_{ij}\right\} \Rot_{kj}+\N_{im}\K_{pm}\Mob^{pr}\left\{ \partial_{k}\K_{rl}\right\} \N_{lj}\Rot_{kj}\right)\nonumber \\
 &  & +O\left(\D t\right)+O(\delta^{2}).
\end{eqnarray}

\end_inset

Combining this with 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slipUUfinal"

\end_inset

 and using equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DNindex"

\end_inset

 gives the desired result 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:EM_RFD_U"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "../References"
options "unsrt"

\end_inset


\end_layout

\end_body
\end_document
